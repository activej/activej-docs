(self.webpackChunkactivejdocs=self.webpackChunkactivejdocs||[]).push([[2429],{2735:function(e,t,n){"use strict";function r(e){return!0===/^(\w*:|\/\/)/.test(e)}function o(e){return void 0!==e&&!r(e)}n.d(t,{b:function(){return r},Z:function(){return o}})},79524:function(e,t,n){"use strict";n.d(t,{C:function(){return a},Z:function(){return i}});var r=n(39962),o=n(2735);function a(){var e=(0,r.Z)().siteConfig,t=(e=void 0===e?{}:e).baseUrl,n=void 0===t?"/":t,a=e.url;return{withBaseUrl:function(e,t){return function(e,t,n,r){var a=void 0===r?{}:r,i=a.forcePrependBaseUrl,l=void 0!==i&&i,s=a.absolute,c=void 0!==s&&s;if(!n)return n;if(n.startsWith("#"))return n;if((0,o.b)(n))return n;if(l)return t+n;var u=n.startsWith(t)?n:t+n.replace(/^\//,"");return c?e+u:u}(a,n,e,t)}}}function i(e,t){return void 0===t&&(t={}),(0,a().withBaseUrl)(e,t)}},51048:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(67294),o=n(30508);function a(){return(0,r.useContext)(o._)}},25406:function(e,t,n){"use strict";var r=n(67294).createContext(void 0);t.Z=r},74925:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var r=n(83117),o=n(80102),a=n(67294),i=n(86010),l=n(51048),s=n(48002),c={themedImage:"themedImage_1VuW","themedImage--light":"themedImage--light_3UqQ","themedImage--dark":"themedImage--dark_hz6m"},u=["sources","className","alt"],d=function(e){var t=(0,l.Z)(),n=(0,s.Z)().isDarkTheme,d=e.sources,p=e.className,k=e.alt,m=void 0===k?"":k,v=(0,o.Z)(e,u),h=t?n?["dark"]:["light"]:["light","dark"];return a.createElement(a.Fragment,null,h.map((function(e){return a.createElement("img",(0,r.Z)({key:e,src:d[e],alt:m,className:(0,i.Z)(c.themedImage,c["themedImage--"+e],p)},v))})))}},48002:function(e,t,n){"use strict";var r=n(67294),o=n(25406);t.Z=function(){var e=(0,r.useContext)(o.Z);if(null==e)throw new Error('"useThemeContext" is used outside of "Layout" component. Please see https://docusaurus.io/docs/api/themes/configuration#usethemecontext.');return e}},77618:function(e,t,n){"use strict";var r=n(67294),o=n(39962);t.Z=function(e){var t=e.url,n=e.text,a=e.isInline,i=void 0===a||a,l=e.children,s=(0,o.Z)().siteConfig,c=t.startsWith("/examples")?s.customFields.githubExamplesBranch:s.customFields.githubBranch;return r.createElement("a",{style:i?{}:{display:"block",marginBottom:"16px"},href:s.customFields.githubUrl+"/"+c+t,target:"_blank"},n||l)}},14304:function(e,t,n){"use strict";var r=n(67294),o=n(21140),a=n.n(o);a().initialize({startOnLoad:!0});t.Z=function(e){var t=e.chart;return(0,r.useEffect)((function(){a().contentLoaded()}),[]),r.createElement("div",{className:"mermaid"},t)}},77815:function(e,t,n){"use strict";n(67294);var r=n(39962);t.Z=function(e){var t=e.name,n=(0,r.Z)().siteConfig;if(!t)throw new Error("Variable name is required");if(void 0===n.customFields[t])throw new Error("Variable "+t+" not exist");return n.customFields[t]}},80787:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return p},contentTitle:function(){return k},metadata:function(){return m},toc:function(){return v},default:function(){return g}});var r=n(83117),o=n(80102),a=(n(67294),n(3905)),i=n(14304),l=n(77618),s=n(74925),c=n(79524),u=n(77815),d=["components"],p={title:"ActiveJ | Workers\uff0c\u514b\u670d\u591a\u7ebf\u7a0b\u7f16\u7a0b\u6a21\u578b\u7684\u590d\u6742\u6027\u548c\u5f00\u9500",sidebar_label:"\u5de5\u4eba",description:"ActiveJ Workers\u5141\u8bb8\u514b\u670d\u591a\u7ebf\u7a0b\u7f16\u7a0b\u6a21\u578b\u7684\u590d\u6742\u6027\u548c\u5f00\u9500\uff0c\u4f46\u540c\u65f6\u4fdd\u7559\u4e86Java\u7684\u591a\u7ebf\u7a0b\u529f\u80fd\u3002",sidebar_position:3},k="\u5de5\u4eba",m={unversionedId:"boot/workers",id:"boot/workers",isDocsHomePage:!1,title:"ActiveJ | Workers\uff0c\u514b\u670d\u591a\u7ebf\u7a0b\u7f16\u7a0b\u6a21\u578b\u7684\u590d\u6742\u6027\u548c\u5f00\u9500",description:"ActiveJ Workers\u5141\u8bb8\u514b\u670d\u591a\u7ebf\u7a0b\u7f16\u7a0b\u6a21\u578b\u7684\u590d\u6742\u6027\u548c\u5f00\u9500\uff0c\u4f46\u540c\u65f6\u4fdd\u7559\u4e86Java\u7684\u591a\u7ebf\u7a0b\u529f\u80fd\u3002",source:"@site/i18n/zh/docusaurus-plugin-content-docs/current/boot/workers.mdx",sourceDirName:"boot",slug:"/boot/workers",permalink:"/zh/boot/workers",tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"ActiveJ | Workers\uff0c\u514b\u670d\u591a\u7ebf\u7a0b\u7f16\u7a0b\u6a21\u578b\u7684\u590d\u6742\u6027\u548c\u5f00\u9500",sidebar_label:"\u5de5\u4eba",description:"ActiveJ Workers\u5141\u8bb8\u514b\u670d\u591a\u7ebf\u7a0b\u7f16\u7a0b\u6a21\u578b\u7684\u590d\u6742\u6027\u548c\u5f00\u9500\uff0c\u4f46\u540c\u65f6\u4fdd\u7559\u4e86Java\u7684\u591a\u7ebf\u7a0b\u529f\u80fd\u3002",sidebar_position:3},sidebar:"docs",previous:{title:"\u670d\u52a1\u56fe\u8868",permalink:"/zh/boot/servicegraph"},next:{title:"\u914d\u7f6e",permalink:"/zh/boot/config"}},v=[{value:"\u6982\u8ff0",id:"\u6982\u8ff0",children:[],level:2},{value:"ActiveJ\u7ebf\u7a0b\u6a21\u578b",id:"activej\u7ebf\u7a0b\u6a21\u578b",children:[],level:2},{value:"\u5de5\u4eba\u8303\u56f4",id:"\u5de5\u4eba\u8303\u56f4",children:[{value:"\u95ee\u9898",id:"\u95ee\u9898",children:[],level:3},{value:"\u89e3\u51b3\u65b9\u6848",id:"\u89e3\u51b3\u65b9\u6848",children:[],level:3}],level:2},{value:"\u5b9e\u4f8b",id:"\u5b9e\u4f8b",children:[{value:"\u57fa\u672c\u5de5\u4eba\u6c60\u5b9e\u4f8b",id:"\u57fa\u672c\u5de5\u4eba\u6c60\u5b9e\u4f8b",children:[],level:3},{value:"\u591a\u7ebf\u7a0b\u5de5\u4f5c\u6c60\u7684\u534f\u4f5c",id:"\u591a\u7ebf\u7a0b\u5de5\u4f5c\u6c60\u7684\u534f\u4f5c",children:[],level:3}],level:2}],h={toc:v};function g(e){var t=e.components,n=(0,o.Z)(e,d);return(0,a.kt)("wrapper",(0,r.Z)({},h,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"\u5de5\u4eba"},"\u5de5\u4eba"),(0,a.kt)("h2",{id:"\u6982\u8ff0"},"\u6982\u8ff0"),(0,a.kt)("p",null,"\u5de5\u4eba(",(0,a.kt)(l.Z,{url:"/boot-workers/src/main/java/io/activej/worker/WorkerPoolModule.java",mdxType:"Githublink"},'\u5de5\u4f5c\u6c60\u6a21\u5757"\u3002')," \u7279\u522b\u662f\uff09\u662f\u4e00\u79cd\u65b9\u4fbf\u7684\u65b9\u6cd5\uff0c\u53ef\u4ee5 \uff0c\u6ce8\u5165\u540c\u4e00\u7c7b\u578b\u7684\u591a\u4e2a\u4f9d\u8d56\u3002 \u5f53\u4f60\u9700\u8981\uff0c\u4f8b\u5982\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u6709\u76f8\u540c\u7684\u4f9d\u8d56\u5173\u7cfb\u65f6\uff0c\u5b83\u662f\u6709\u7528\u7684\u3002 ActiveJ\u5927\u91cf\u5229\u7528workers \u6765\u5b9e\u73b0\u591a\u7ebf\u7a0b\u3002 \u5de5\u4eba\u662fActiveJ\u7ebf\u7a0b\u6a21\u578b\u7684\u57fa\u7840\u3002"),(0,a.kt)("h2",{id:"activej\u7ebf\u7a0b\u6a21\u578b"},"ActiveJ\u7ebf\u7a0b\u6a21\u578b"),(0,a.kt)("p",null,"ActiveJ\u7684\u4e3b\u8981\u4efb\u52a1\u662f\u6700\u7ec8\u521b\u5efa\u5feb\u901f\u3001\u53ef\u6269\u5c55\u3001\u7b80\u5355\u6613\u7528\u3001\u9ad8\u62bd\u8c61\u5ea6\u7684I/O\u5f02\u6b65 \u7f16\u7a0b\u6a21\u578b\u3002 \u4e3a\u4e86\u5b9e\u73b0\u8fd9\u4e00\u76ee\u6807\uff0cActiveJ\u7684\u8bbe\u8ba1\u539f\u5219\u514b\u670d\u4e86\u4f20\u7edf\u7684 \u591a\u7ebf\u7a0b\u7f16\u7a0b\u6a21\u578b\u7684\u6240\u6709\u6027\u80fd\u5f00\u9500\u548c\u590d\u6742\u6027\uff0c\u4f46\u53c8\u5145\u5206\u5229\u7528\u4e86Java\u7684\u591a\u7ebf\u7a0b\u80fd\u529b\u3002 ActiveJ\u63d0\u4f9b\u4e86\u5c06\u5e94\u7528\u7a0b\u5e8f\u62c6\u5206\u4e3a ",(0,a.kt)("inlineCode",{parentName:"p"},"Primary Eventloop")," \u7ebf\u7a0b\u548c ",(0,a.kt)("inlineCode",{parentName:"p"},"Worker\nEventloop")," \u7ebf\u7a0b\u7684\u624b\u6bb5\u3002 \u8fd9\u4e9b\u7ebf\u7a0b\u901a\u8fc7\u6d88\u606f\u4f20\u9012\u548c\u7ebf\u7a0b\u5b89\u5168\u7684\u7279\u5b9a\u5e94\u7528 \u5355\u5143\u670d\u52a1\u76f8\u4e92\u901a\u4fe1\u3002"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"/zh/async-io/eventloop"},(0,a.kt)("inlineCode",{parentName:"a"},"Eventloop"))," \u7ebf\u7a0b\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u5355\u7ebf\u7a0b\u7684\u5c0f\u578b\u5e94\u7528 \uff08\u7c7b\u4f3c\u4e8eNode.js\uff09\uff0c\u5b83\u5904\u7406\u5176\u90e8\u5206I/O\u4efb\u52a1\u5e76\u6267\u884c\u4ece\u5176\u4ed6\u7ebf\u7a0b\u63d0\u4ea4\u7684Runnable\u3002 \u4e3b\u8981\u7684Eventloop\u7ebf\u7a0b\u5728Worker\u7ebf\u7a0b\u4e4b\u95f4\u5206\u914d\u548c\u5e73\u8861I/O\u4efb\u52a1\u3002"),(0,a.kt)(i.Z,{style:{margin:"0 auto"},chart:"\ngraph TB\n    id1(Primary Event Loop) --\x3e id2(Worker Balancer)\n    id2 --\x3e id4\n    subgraph Worker Scope\n    id3(Event Loop) --\x3e id4(HTTP Server)\n    end\n    id2 --\x3e id6\n    subgraph Worker Scope\n    id5(Event Loop) --\x3e id6(HTTP Server)\n    end\n",mdxType:"Mermaid"}),(0,a.kt)("p",null,"ActiveJ\u7ebf\u7a0b\u6a21\u578b\u7684\u597d\u5904\u3002"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u6bcf\u4e2a\u4e3b/\u5de5\u4f5cEventloop\u7ebf\u7a0b\u4f5c\u4e3a\u4e00\u4e2a\u5355\u7ebf\u7a0b\u7684\u5e94\u7528\u7a0b\u5e8f\u5de5\u4f5c\uff0c\u5176\u7f16\u7a0b\u548c\u63a8\u7406\u90fd\u5f88\u7b80\u5355"),(0,a.kt)("li",{parentName:"ul"},"\u6ca1\u6709\u591a\u7ebf\u7a0b\u7684\u5f00\u9500\u3001\u7ade\u8d5b\u548c\u7ebf\u7a0b\u540c\u6b65\u7684\u5f00\u9500"),(0,a.kt)("li",{parentName:"ul"},"Java\u5728\u591a\u7ebf\u7a0b\u7f16\u7a0b\u65b9\u9762\u7684\u4f20\u7edf\u4f18\u52bf\u88ab\u5b8c\u5168\u4fdd\u7559\u4e86\u4e0b\u6765\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u5178\u578b\u7684I/O\u8d1f\u8f7d\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u5728\u5de5\u4f5c\u7ebf\u7a0b\u4e4b\u95f4\u8fdb\u884c\u5206\u5272"),(0,a.kt)("li",{parentName:"ul"},"\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u6709\u7ebf\u7a0b\u5b89\u5168\u7684\u5355\u5b50\u670d\u52a1\uff0c\u7531Eventloop\u7ebf\u7a0b\u4f7f\u7528\uff0c\u8fd8\u6709\u4e00\u4e2a\u5de8\u5927\u7684\u5355\u5b50 \u6570\u636e\u72b6\u6001\uff0c\u7531\u6240\u6709\u5de5\u4f5c\u7ebf\u7a0b\u5171\u4eab\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u4f60\u4ecd\u7136\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u7ebf\u7a0b\u540c\u6b65/\u65e0\u9501\u7b97\u6cd5\uff0c\u53ea\u662f\u8981\u5c3d\u91cf\u907f\u514d \u5e76\u53d1\u7ebf\u7a0b\u7684\u8fc7\u5ea6\u963b\u585e\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u5728Java\u7ebf\u7a0b\u3001\u7ebf\u7a0b\u6c60\u3001Java\u671f\u8d27\uff0c\u751a\u81f3\u662f\u963b\u585e\u7684I/O\u64cd\u4f5c\u4e4b\u95f4\u5177\u6709\u5b8c\u5168\u7684\u4e92\u64cd\u4f5c\u6027")),(0,a.kt)("h2",{id:"\u5de5\u4eba\u8303\u56f4"},"\u5de5\u4eba\u8303\u56f4"),(0,a.kt)("h3",{id:"\u95ee\u9898"},"\u95ee\u9898"),(0,a.kt)("p",null,"\u8fd9\u79cd\u8bbe\u8ba1\u63d0\u51fa\u4e86\u4e00\u4e9b\u5b9e\u65bd\u95ee\u9898\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u6211\u4eec\u60f3\u7528\u5de5\u4f5c\u8005\u7684\u4e8b\u4ef6\u5faa\u73af\u6765\u5b9e\u73b0\u591a\u7ebf\u7a0b\u7684HTTP\u7f51\u7edc\u5e94\u7528\u3002"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u6839\u636e\u8fd9\u4e9b\u8bbe\u8ba1\u539f\u5219\uff0c\u6211\u4eec\u9700\u8981\u4e3a\u6bcf\u4e2a\u5de5\u4f5c\u7ebf\u7a0b\u521b\u5efa\u72ec\u7acb\u7684\u5de5\u4f5c\u4e8b\u4ef6\u73af\u3001\u5355\u7ebf\u7a0bHTTP \u670d\u52a1\u5668\u53ca\u5176Servlets\u7684\u5b9e\u4f8b\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u4f46\u662f\uff0c\u5982\u679c\u6211\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u67098\u4e2a\u4e8b\u4ef6\u5faa\u73af\u7ebf\u7a0b\uff0c\u91cc\u9762\u670910\u4e2a\u5de5\u4eba\u7ebf\u7a0b\u7ec4\u4ef6\uff0c\u6211\u4eec\u662f\u5426\u5fc5\u987b\u603b\u5171\u521b\u5efa80\u4e2a \uff0c\u5e76\u5c06\u5b83\u4eec\u5206\u914d\u7ed9\u6bcf\u4e2a\u5de5\u4eba\u7ebf\u7a0b\uff1f"),(0,a.kt)("li",{parentName:"ul"},"\u5982\u4f55\u624d\u80fd\u4ee5\u6b63\u786e\u7684\u987a\u5e8f\u624b\u52a8\u5b9e\u4f8b\u5316\u3001\u63a5\u7ebf\u3001\u521d\u59cb\u5316\u548c\u542f\u52a8/\u505c\u6b62\u6240\u6709\u8fd9\u4e9b\u7ec4\u4ef6\uff0c\u5e76\u5728\u542f\u52a8/\u505c\u6b62\u9519\u8bef\u65f6\u4f18\u96c5\u5730\u5173\u95ed\u5e94\u7528\u7a0b\u5e8f\uff1f")),(0,a.kt)("h3",{id:"\u89e3\u51b3\u65b9\u6848"},"\u89e3\u51b3\u65b9\u6848"),(0,a.kt)("p",null,"\u5e78\u8fd0\u7684\u662f\uff0c\u7531\u4e8e ",(0,a.kt)("a",{parentName:"p",href:"/zh/inject"},"ActiveJ Inject"),"\uff0c\u6211\u4eec\u6709\u4e00\u4e2a\u89e3\u51b3\u65b9\u6848 - ",(0,a.kt)("inlineCode",{parentName:"p"},"@Worker")," \u8303\u56f4\u3002 \u5982\u679c\u4f60\u9700\u8981\u5b9e\u73b0\u51e0\u4e2a\u5de5\u4f5c\u7ebf\u7a0b\u3002"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u5305\u62ec ",(0,a.kt)(l.Z,{url:"/boot-workers/src/main/java/io/activej/worker/WorkerPoolModule.java",mdxType:"Githublink"},'\u5de5\u4f5c\u6c60\u6a21\u5757"\u3002')," \u6a21\u5757\uff0c\u5e76\u521b\u5efa\u4e00\u4e2a ",(0,a.kt)(l.Z,{url:"/boot-workers/src/main/java/io/activej/worker/WorkerPool.java",mdxType:"Githublink"},'\u5de5\u4f5c\u8005\u6c60"\u3002')," \u5b9e\u4f8b"),(0,a.kt)("li",{parentName:"ul"},"\u7528 ",(0,a.kt)("inlineCode",{parentName:"li"},"@Worker")," \u8303\u56f4\u6ce8\u89e3\u6765\u6ce8\u89e3\u4f60\u5e0c\u671b\u653e\u5165\u6bcf\u4e2a\u5de5\u4f5c\u7ebf\u7a0b\u7684\u7ec4\u4ef6")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"WorkerPool")," \u5c06\u4e3a\u6bcf\u4e2a\u5de5\u4eba\u7ebf\u7a0b\u81ea\u52a8\u5b9e\u4f8b\u5316\u76f8\u540c\u7684\u4f9d\u8d56\u56fe \u4f60\u7edd\u4e0d\u9650\u4e8e\u4e0a\u8ff0\u7684\u65b9\u6848\uff0c\u5373\u4e00\u4e2a\u4e3b\u4e8b\u4ef6\u73af\u548cN\u4e2a\u5de5\u4eba\u4e8b\u4ef6\u73af\u3002"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u4f60\u4ecd\u7136\u53ef\u4ee5\u6709\u5b8c\u5168\u4e0d\u76f8\u5173\u7684/\u72ec\u7acb\u7684\u4e8b\u4ef6\u73af\uff08\u4e5f\u4e0d\u662f\u4e3b\u8981\u7684\uff0c\u4e5f\u4e0d\u662f\u5de5\u4f5c\u8005\uff09\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u51e0\u4e2a\u4e3b\u8981\u7684\u4e8b\u4ef6\u5faa\u73af\u5171\u4eab\u540c\u4e00\u4e2a\u5de5\u4eba\u4e8b\u4ef6\u5faa\u73af\u6c60\uff0c\u6216\u8005\u51e0\u7ec4\u5177\u6709\u4e0d\u540c\u6570\u91cf\u6216\u7ebf\u7a0b\u7684\u5de5\u4eba\u6c60\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u4f60\u751a\u81f3\u53ef\u4ee5\u5b9a\u4e49\u4f60\u81ea\u5df1\u7684 ",(0,a.kt)("inlineCode",{parentName:"li"},"@Worker")," \u6ce8\u89e3\uff0c\u5e76\u521b\u5efa\u591a\u4e2a\u5177\u6709\u5b8c\u5168\u4e0d\u76f8\u5173\u548c \u4e0d\u540c\u4f9d\u8d56\u5173\u7cfb\u56fe\u7684\u5de5\u4f5c\u8005\u6c60 \u6240\u6709\u8fd9\u4e9b\u90fd\u662f\u5b8c\u5168\u900f\u660e\u548c\u6613\u4e8e\u7406\u89e3\u7684\u6a21\u5757 - \u53ea\u8981\u7528\u9002\u5f53\u7684 worker \u6ce8\u89e3\u6807\u8bb0\u4e0d\u540c\u7684\u7ec4\u4ef6\uff0c\u8ba9 ",(0,a.kt)("inlineCode",{parentName:"li"},"WorkerPool")," \u521b\u5efa\u6240\u6709\u5b9e\u4f8b")),(0,a.kt)("p",null,"\u8981\u4ee5\u6b63\u786e\u7684\u987a\u5e8f\u81ea\u52a8\u542f\u52a8/\u505c\u6b62\u5e94\u7528\u7a0b\u5e8f\u7ec4\u4ef6\uff0c\u53ea\u9700\u5c06 ",(0,a.kt)("inlineCode",{parentName:"p"},"ServiceGraph")," \u6a21\u5757\u7eb3\u5165\u4f60\u7684 ",(0,a.kt)("strong",{parentName:"p"},"Launcher")," - \u5b83\u77e5\u9053\u5de5\u4f5c\u8005\u6c60\uff0c\u5e76\u5c06\u5de5\u4f5c\u8005\u5b9e\u4f8b\u7684\u5411\u91cf\u89c6\u4e3a\u7279\u6b8a\u7684\u590d\u5408\u5355\u5b50\u7c7b\u5b9e\u4f8b\u3002"),(0,a.kt)("p",null,"\u4f8b\u5982\uff0c\u8fd9\u91cc\u6709\u4e00\u4e2a\u5229\u7528\u7684\u4f8b\u5b50 ",(0,a.kt)(l.Z,{url:"/launchers/http/src/main/java/io/activej/launchers/http/MultithreadedHttpServerLauncher.java",mdxType:"Githublink"},(0,a.kt)("inlineCode",{parentName:"p"},"\u591a\u7ebf\u7a0bHttpServerLauncher"),"\u3002")," \u5176\u7279\u70b9\u662f ",(0,a.kt)("inlineCode",{parentName:"p"},"ServiceGraphModule"),"\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java",metastring:"url=/examples/core/http/src/main/java/MultithreadedHttpServerExample.java tag=EXAMPLE",url:"/examples/core/http/src/main/java/MultithreadedHttpServerExample.java",tag:"EXAMPLE"},'public final class MultithreadedHttpServerExample extends MultithreadedHttpServerLauncher {\n  @Provides\n  @Worker\n  AsyncServlet servlet(@WorkerId int workerId) {\n    return request -> HttpResponse.ok200()\n      .withPlainText("Hello from worker server #" + workerId + "\\n")\n      .toPromise();\n  }\n\n  public static void main(String[] args) throws Exception {\n    MultithreadedHttpServerExample example = new MultithreadedHttpServerExample();\n    example.launch(args);\n  }\n}\n')),(0,a.kt)("p",null,"\u5176\u4f9d\u8d56\u5173\u7cfb\u56fe\u770b\u8d77\u6765\u5982\u4e0b\u3002"),(0,a.kt)(i.Z,{chart:'\ngraph\n    subgraph "@Worker()"\n    id1(AsyncHTTPServer) --\x3e id2(EventLoop)\n    id1 --\x3e id3(Async Servlet)\n    id3 --\x3e id4("@WorkerId() int")\n    end\n    id2 -.-> ThrottlingController\n    id2 --\x3e id5(Config)\n    id1 --\x3e id5\n    id9 --\x3e id5\n    id6(EventLoop) --\x3e id5\n    id7(Primary Server) --\x3e id5\n    id7 --\x3e id6\n    id7 --\x3e id8(WorkerPool$Intsnces)\n    id8 --\x3e id9(WorkerPool)\n    id9 --\x3e id10(WorkerPools)\n    id10 --\x3e Injector\n',mdxType:"Mermaid"}),(0,a.kt)("p",null,"\u4e3a\u4e86\u5e2e\u52a9\u4f60\u7406\u89e3\u5de5\u4f5c\u8005\u6c60\u7684\u5de5\u4f5c\u539f\u7406\uff0c\u8fd9\u91cc\u6709\u4e00\u4e2a\u7b80\u5316\u7684 ",(0,a.kt)("strong",{parentName:"p"},"WorkerPool")," \u5b9e\u73b0\uff0c\u7b80\u800c\u8a00\u4e4b\uff08\u5b9e\u9645\u5b9e\u73b0\u6709\u5dee\u5f02\uff0c\u4f46\u5dee\u5f02\u4e0d\u5927\uff09\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},"public final class WorkerPool {\n    private final Scope scope;\n    private final Injector[] scopeInjectors;\n\n    WorkerPool(Injector injector, Scope scope, int workers) {\n        this.scope = scope;\n        this.scopeInjectors = new Injector[workers];\n        for (int i = 0; i < workers; i ) {\n            scopeInjectors[i] = injector.enterScope( scope, new HashMap<(), false);\n        }\n    }\n\n    public <T> Instances<T> getInstances(Key<T> key) {\n        Instances<T> instances = new Instances<>( new Object[scopeInjectors.length]);\n        for (int i = 0; i < scopeInjectors.length; i ) {\n            instances.instances[i] = scopeInjectors[i].getInstance(key);\n        }\n        return instances;\n    }\n}\n")),(0,a.kt)("p",null,"\u6b63\u5982\u4f60\u6240\u770b\u5230\u7684\uff0c\u6839 ",(0,a.kt)(l.Z,{url:"/core-inject/src/main/java/io/activej/inject/Injector.java",mdxType:"Githublink"},"\u6ce8\u5c04\u5668"),' \u7b80\u5355\u5730 "\u8fdb\u5165 "\u5de5\u4eba\u8303\u56f4 ',(0,a.kt)("inlineCode",{parentName:"p"},"N")," \u6b21\uff0c\u6240\u4ee5\u6211\u4eec\u6709 ",(0,a.kt)("inlineCode",{parentName:"p"},"N")," ",(0,a.kt)("inlineCode",{parentName:"p"},"\u6ce8\u5c04\u5668"),"s \u5177\u6709\u76f8\u540c\u7684\u7ed1\u5b9a/\u4f9d\u8d56\u56fe\uff0c\u4f46 \u4e0d\u540c\u7684\u5b9e\u4f8b\u5bb9\u5668\u3002 \u6bcf\u6b21\u6211\u4eec\u9700\u8981\u521b\u5efa\u4e00\u4e9b ",(0,a.kt)("em",{parentName:"p"},"\u5de5\u4f5c\u8005")," \u5b9e\u4f8b\u65f6\uff0c\u5b83\u4eec\u4f1a\u88ab \u6bcf\u4e2a ",(0,a.kt)("em",{parentName:"p"},"\u6ce8\u5165\u5668")," \u521b\u5efaN\u6b21 ",(0,a.kt)("inlineCode",{parentName:"p"},"\uff0c\u5e76\u4f5c\u4e3a\u4e00\u4e2a <code>N")," \u5b9e\u4f8b\u7684\u5411\u91cf\u8fd4\u56de\u3002"),(0,a.kt)("h2",{id:"\u5b9e\u4f8b"},"\u5b9e\u4f8b"),(0,a.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"\u8981\u8fd0\u884c\u4f8b\u5b50\uff0c\u4f60\u9700\u8981\u4eceGitHub\u514b\u9686ActiveJ"),(0,a.kt)("pre",{parentName:"div"},(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"git clone https://github.com/activej/activej\n")),(0,a.kt)("p",{parentName:"div"},"\u5e76\u5c06\u5176\u4f5c\u4e3a\u4e00\u4e2aMaven\u9879\u76ee\u5bfc\u5165\u3002 \u67e5\u770b\u6807\u7b7e ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)(u.Z,{name:"currentVersion",mdxType:"Variable"})),"\u3002 \u5728\u8fd0\u884c\u8fd9\u4e9b\u4f8b\u5b50\u4e4b\u524d\uff0c\u5148\u5efa\u7acb\u9879\u76ee\u3002 \u8fd9\u4e9b\u4f8b\u5b50\u4f4d\u4e8e ",(0,a.kt)("inlineCode",{parentName:"p"},"activej/examples/core/boot")))),(0,a.kt)("h3",{id:"\u57fa\u672c\u5de5\u4eba\u6c60\u5b9e\u4f8b"},"\u57fa\u672c\u5de5\u4eba\u6c60\u5b9e\u4f8b"),(0,a.kt)("p",null,"\u521b\u5efa\u4e00\u4e2a\u67094\u4e2a\u5de5\u4eba\u7684\u5de5\u4eba\u6c60\u7684\u4f8b\u5b50\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java",metastring:"url=/examples/core/boot/src/main/java/WorkerPoolModuleExample.java tag=EXAMPLE",url:"/examples/core/boot/src/main/java/WorkerPoolModuleExample.java",tag:"EXAMPLE"},'public final class WorkerPoolModuleExample extends AbstractModule {\n  @Provides\n  WorkerPool workerPool(WorkerPools workerPools) {\n    return workerPools.createPool(4);\n  }\n\n  @Provides\n  @Worker\n  String string(@WorkerId int workerId) {\n    return "Hello from worker #" + workerId;\n  }\n\n  public static void main(String[] args) {\n    Injector injector = Injector.of(WorkerPoolModule.create(), new WorkerPoolModuleExample());\n    WorkerPool workerPool = injector.getInstance(WorkerPool.class);\n    WorkerPool.Instances<String> strings = workerPool.getInstances(String.class);\n    strings.forEach(System.out::println);\n  }\n}\n')),(0,a.kt)("p",null,"\u8fd9\u4e2a\u4f8b\u5b50\u7684\u4f9d\u8d56\u5173\u7cfb\u56fe\u5305\u62ec\u521b\u5efa\u7684\u5de5\u4eba\u6c60\uff0c\u770b\u8d77\u6765\u5982\u4e0b\u3002"),(0,a.kt)("div",{style:{width:"100%",display:"flex"}},(0,a.kt)(s.Z,{style:{margin:"0 auto"},alt:"Dependency graph",sources:{light:(0,c.Z)("/img/worker-pool-dependencies_dark.svg"),dark:(0,c.Z)("/img/worker-pool-dependencies_light.svg")},mdxType:"ThemedImage"})),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},(0,a.kt)(l.Z,{url:"/examples/core/boot/src/main/java/WorkerPoolModuleExample.java",mdxType:"Githublink"},"\u5728GitHub\u4e0a\u770b\u5230\u5b8c\u6574\u7684\u4f8b\u5b50"))),(0,a.kt)("h3",{id:"\u591a\u7ebf\u7a0b\u5de5\u4f5c\u6c60\u7684\u534f\u4f5c"},"\u591a\u7ebf\u7a0b\u5de5\u4f5c\u6c60\u7684\u534f\u4f5c"),(0,a.kt)("p",null,"\u51e0\u4e2a\u5de5\u4eba\u6c60\u53ef\u4ee5\u5171\u540c\u5de5\u4f5c\uff0c\u8ba1\u7b97\u4e00\u4e2a\u5355\u4e00\u7684\u4efb\u52a1\u3002 \u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u670925\u4e2a\u5de5\u4eba\uff0c\u6bcf\u4e2a\u5de5\u4eba\u90fd\u6709\u81ea\u5df1\u7684Eventloop\uff0c \u3002 \u8fd9\u4e9bEventloops\u88ab\u5305\u88f9\u5728Threads\u4e2d\uff0c\u7136\u540e\u88ab\u6dfb\u52a0\u5230 ",(0,a.kt)("em",{parentName:"p"},"threads\u7684\u5217\u8868\u4e2d"),"\u3002 \u4e4b\u540e\uff0c \u5217\u8868\u88ab\u6392\u5217\uff0c\u5e26\u6709Eventloop\u4efb\u52a1\u7684\u7ebf\u7a0b\u5f00\u59cb\u3002 \u4efb\u52a1\u662f\u5c06Eventloop ",(0,a.kt)("em",{parentName:"p"},"id")," \u6309\u7167\u5ef6\u8fdf\uff08 ",(0,a.kt)("em",{parentName:"p"},"id")," \u4e58\u4ee5100\uff09\u653e\u5165 ",(0,a.kt)("strong",{parentName:"p"},"ConcurrentLinkedQueue")," \u3002 \u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u6211\u4eec\u6536\u5230\u4e00\u4e2a\u6709\u5e8f\u7684Eventloop id\u961f\u5217\uff0c\u4e4b\u540e \uff0c\u7ebf\u7a0b\u505c\u653e\uff0c\u961f\u5217\u88ab\u6e05\u7a7a\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java",metastring:"url=/examples/core/boot/src/main/java/MultithreadedWorkerCollab.java tag=EXAMPLE",url:"/examples/core/boot/src/main/java/MultithreadedWorkerCollab.java",tag:"EXAMPLE"},"public final class MultithreadedWorkerCollab extends AbstractModule {\n\n  @Provides\n  @Worker\n  Eventloop eventloop(@WorkerId int wid, ConcurrentLinkedQueue<Integer> queue) {\n    Eventloop eventloop = Eventloop.create();\n    eventloop.delay(100L * wid, () -> queue.add(wid));\n    return eventloop;\n  }\n\n  @Provides\n  WorkerPool workerPool(WorkerPools workerPools) {\n    return workerPools.createPool(25);\n  }\n\n  @Provides\n  ConcurrentLinkedQueue<Integer> queue() {\n    return new ConcurrentLinkedQueue<>();\n  }\n\n  public static void main(String[] args) throws InterruptedException {\n    Injector injector = Injector.of(WorkerPoolModule.create(), new MultithreadedWorkerCollab());\n    WorkerPool workerPool = injector.getInstance(WorkerPool.class);\n    WorkerPool.Instances<Eventloop> eventloops = workerPool.getInstances(Eventloop.class);\n\n    List<Thread> threads = new ArrayList<>();\n    for (Eventloop eventloop : eventloops.getList()) {\n      Thread thread = new Thread(eventloop);\n      threads.add(thread);\n    }\n\n    Collections.shuffle(threads);\n    threads.forEach(Thread::start);\n\n    for (Thread thread : threads) {\n      thread.join();\n    }\n\n    ConcurrentLinkedQueue<Integer> queue = injector.getInstance(new Key<>() {});\n\n    while (!queue.isEmpty()) {\n      System.out.println(queue.poll());\n    }\n\n  }\n}\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},(0,a.kt)(l.Z,{url:"/examples/core/boot/src/main/java/MultithreadedWorkerCollab.java",mdxType:"Githublink"},"\u5728GitHub\u4e0a\u770b\u5230\u5b8c\u6574\u7684\u4f8b\u5b50"))))}g.isMDXComponent=!0},86010:function(e,t,n){"use strict";function r(e){var t,n,o="";if("string"==typeof e||"number"==typeof e)o+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=r(e[t]))&&(o&&(o+=" "),o+=n);else for(t in e)e[t]&&(o&&(o+=" "),o+=t);return o}function o(){for(var e,t,n=0,o="";n<arguments.length;)(e=arguments[n++])&&(t=r(e))&&(o&&(o+=" "),o+=t);return o}n.d(t,{Z:function(){return o}})},11748:function(e,t,n){var r={"./locale":89234,"./locale.js":89234};function o(e){var t=a(e);return n(t)}function a(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=a,e.exports=o,o.id=11748}}]);