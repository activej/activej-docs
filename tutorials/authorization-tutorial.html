<!DOCTYPE html>
<html lang="en">
<head>
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-176574648-1"></script>
    <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-176574648-1');
    </script>
    
    <link rel='stylesheet' href='/static/css/pygment_trac.css'/>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300i,400,400i,500,500i,600,600i,700,700i&display=swap' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/static/css/main.css">
    <link rel="shortcut icon" type="image/png" href="/favicon.png">
    <title>ActiveJ | Simple app with authorization and session management</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content=" Create a Java web application with authorization and session management in about 100 lines of code using ActiveJ platform. ">
    <meta name="keywords" content=" java,for beginners,java framework,guide,tutorial,web application,async,spring,spring alternative,netty alternative,jetty alternative,authorization,server,client,servlet ">
    <meta http-equiv='Content-Type' content='text/html; charset=utf-8'/>
    <meta name="og:description" content="ActiveJ is an alternative Java platform built from the ground up as a replacement of Spring, Spark, Quarkus, Micronauts, and other solutions. It is minimalistic, boilerplate-free, and provides outstanding performance." />
    <meta name="og:image" content="https://activej.io/static/images/AJ_Card.jpeg" />
    <meta name="og:title" content="ActiveJ - An Alternative Java platform built for web, high load, and cloud development" />
</head>
<body>
    <div class="navbar-container-wrapper">
    <div class="container">
        <nav class="navbar navbar-expand-lg navbar-light p-0">
            <ul class="navbar-nav-visible mr-auto mt-1 mt-lg-0">
                <div class="logo-link-title mr-5">
                    <img src="/favicon.png" style="max-width: 25px">
                    
                    
                    <a class="navbar-nav__link logo-link-title" href="/" style="margin-left: 5px">ActiveJ</a>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                </div>
            </ul>
            <button class="navbar-toggler m-1 ml-auto" type="button" data-toggle="collapse" data-target="#navbarToggler"
                    aria-controls="navbarToggler" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarToggler">
                <div class="container">
                    
                    
                    <ul class="navbar-nav navbar-nav-visible mr-auto mt-1 mt-lg-0">
                        
                        <li>
                            <a class="navbar-nav__link nav-expanded" href="/tutorials/getting-started.html">
                                Tutorials
                            </a>
                        </li>
                        
                        <li>
                            <a class="navbar-nav__link nav-expanded" href="/http.html">
                                Docs
                            </a>
                        </li>
                        
                    </ul>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                </div>
                <span>
              <ul class="navbar-nav expanded-links navbar-nav-visible mr-auto mt-1 mt-lg-0">
                  <li class="dropdown">
                    <a class="nav-link nav-expanded">Components</a>
                    <ul class="dropdown__content">
                        
                            <div class="dropdown__content-wrapper">
                                
                                    <a href="https://activej.io" class="dropdown__content__item  selected-link ">
                                        <li>
                                            <div href="https://activej.io">ActiveJ</div>
                                        </li>
                                        <p class="dropdown__content__item__text"> Redefining Java for modern web applications </p>
                                    </a>
                                
                                    <a href="https://inject.activej.io" class="dropdown__content__item ">
                                        <li>
                                            <div href="https://inject.activej.io">ActiveJ Inject</div>
                                        </li>
                                        <p class="dropdown__content__item__text"> Lightning-fast and ultimately powerful DI library </p>
                                    </a>
                                
                                    <a href="https://serializer.activej.io" class="dropdown__content__item ">
                                        <li>
                                            <div href="https://serializer.activej.io">ActiveJ Serializer</div>
                                        </li>
                                        <p class="dropdown__content__item__text"> The fastest JVM serializer in the world </p>
                                    </a>
                                
                                    <a href="https://codegen.activej.io" class="dropdown__content__item ">
                                        <li>
                                            <div href="https://codegen.activej.io">ActiveJ Codegen</div>
                                        </li>
                                        <p class="dropdown__content__item__text"> Dynamic bytecode generation without overhead of reflection </p>
                                    </a>
                                
                                    <a href="https://specializer.activej.io" class="dropdown__content__item ">
                                        <li>
                                            <div href="https://specializer.activej.io">ActiveJ Specializer</div>
                                        </li>
                                        <p class="dropdown__content__item__text"> A little bit of magic to speed up your code </p>
                                    </a>
                                
                                    <a href="https://rpc.activej.io" class="dropdown__content__item ">
                                        <li>
                                            <div href="https://rpc.activej.io">ActiveJ RPC</div>
                                        </li>
                                        <p class="dropdown__content__item__text"> Lightning-fast binary protocol for microservices architecture </p>
                                    </a>
                                
                                    <a href="https://fs.activej.io" class="dropdown__content__item ">
                                        <li>
                                            <div href="https://fs.activej.io">ActiveJ FS</div>
                                        </li>
                                        <p class="dropdown__content__item__text"> Tiny abstraction for managing local, remote, and distributed FS </p>
                                    </a>
                                
                           </div>
                        
                    </ul>
                </li>
                  <li><a class="navbar-nav__link" href="https://activej.io/blog/release-notes.html">Blog</a> </li>
                <li><a class="navbar-nav__link" href="http://uikernel.io">UIKernel</a></li>
                <li><a class="navbar-nav__link" href="https://adkernel.com">AdKernel</a></li>
                <li><a class="navbar-nav__link" href="https://github.com/activej/activej">GitHub</a></li>
                <li><a class="navbar-nav__link" href="/about.html">About us</a></li>
              </ul>
            </span>
            </div>
        </nav>
    </div>
</div>

    <div class="content">
        
            <div class="container">
                <div class="row">
                    <div class="px-0 mb-3 sidebar">
    
<h3>Tutorials</h3>
<ul>
    
    
    <li>
        <a href="/tutorials/getting-started.html">Getting-Started</a>
    </li>
    
    
    
    <li>
        <a href="/tutorials/template-engine-integration.html">Template Engine Integration</a>
    </li>
    
    
    
    <li>
        <a href="/tutorials/http-decoder.html">HTTP Decoder</a>
    </li>
    
    
    
    <li class="sidebar-item-selected-wrapper">
        <div class="sidebar-item-selected">
            <a href="/tutorials/authorization-tutorial.html">Authorization and Session Management</a>
        </div>
    </li>
    
    
    
    <li>
        <a href="/tutorials/getting-started-advanced.html">ActiveJ + Docker + AWS</a>
    </li>
    
    
    
    <li>
        <a href="/tutorials/using-react.html">ActiveJ + React (getting started)</a>
    </li>
    
    
    
    <li>
        <a href="/tutorials/todo-list-tutorial.html">ActiveJ + React (advanced)</a>
    </li>
    
    
</ul>


</div>
<div class="pr-3 markdown-content docs-content">
    <div class="status-wrapper">
        <h1>ActiveJ | Simple app with authorization and session management </h1>
    </div>
    <h2 id="purpose">Purpose</h2>
<p>In this example we will create a simple authorization app with <strong>login</strong>/<strong>sign up</strong> scenarios 
and session management.</p>

<p>ActiveJ doesn’t include built-in authorization modules or solutions, as this process may significantly vary depending 
on the project’s business logic. This example represents a simple “best practice” which you 
can extend and modify depending on your needs. <strong>You can find full example sources on <a href="https://github.com/activej/activej/blob/v4.3/examples/tutorials/auth">GitHub</a>.</strong></p>

<p>In the example we will consider only the <a href="#creating-launcher">server</a> which was created using ActiveJ <strong>HttpServerLauncher</strong> and 
<strong>AsyncServlet</strong>. This approach allows to create an embedded application server in about 100 lines of code with no 
additional XML configurations or third-party dependencies.</p>

<h2 id="creating-launcher">Creating Launcher</h2>
<p>Let’s create an <strong>AuthLauncher</strong>, which is the main part of the application as it manages the application lifecycle, routing 
and authorization processes. We will use ActiveJ <strong>HttpServerLauncher</strong> and extend it:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">AuthLauncher</span> <span class="kd">extends</span> <span class="nc">HttpServerLauncher</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">SESSION_ID</span> <span class="o">=</span> <span class="s">"SESSION_ID"</span><span class="o">;</span>

	<span class="nd">@Provides</span>
	<span class="nc">AuthService</span> <span class="nf">loginService</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="k">new</span> <span class="nf">AuthServiceImpl</span><span class="o">();</span>
	<span class="o">}</span>

	<span class="nd">@Provides</span>
	<span class="nc">Executor</span> <span class="nf">executor</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="nf">newSingleThreadExecutor</span><span class="o">();</span>
	<span class="o">}</span>

	<span class="nd">@Provides</span>
	<span class="kd">private</span> <span class="nc">StaticLoader</span> <span class="nf">staticLoader</span><span class="o">(</span><span class="nc">Executor</span> <span class="n">executor</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">return</span> <span class="nc">StaticLoader</span><span class="o">.</span><span class="na">ofClassPath</span><span class="o">(</span><span class="n">executor</span><span class="o">,</span> <span class="s">"site/"</span><span class="o">);</span>
	<span class="o">}</span>

	<span class="nd">@Provides</span>
	<span class="nc">SessionStore</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">sessionStore</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="nc">SessionStoreInMemory</span><span class="o">.&lt;</span><span class="nc">String</span><span class="o">&gt;</span><span class="n">create</span><span class="o">()</span>
				<span class="o">.</span><span class="na">withLifetime</span><span class="o">(</span><span class="nc">Duration</span><span class="o">.</span><span class="na">ofDays</span><span class="o">(</span><span class="mi">30</span><span class="o">));</span>
	<span class="o">}</span>

	<span class="nd">@Provides</span>
	<span class="nc">AsyncServlet</span> <span class="nf">servlet</span><span class="o">(</span><span class="nc">SessionStore</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">sessionStore</span><span class="o">,</span>
			<span class="nd">@Named</span><span class="o">(</span><span class="s">"public"</span><span class="o">)</span> <span class="nc">AsyncServlet</span> <span class="n">publicServlet</span><span class="o">,</span> <span class="nd">@Named</span><span class="o">(</span><span class="s">"private"</span><span class="o">)</span> <span class="nc">AsyncServlet</span> <span class="n">privateServlet</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">return</span> <span class="nc">SessionServlet</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">sessionStore</span><span class="o">,</span> <span class="no">SESSION_ID</span><span class="o">,</span> <span class="n">publicServlet</span><span class="o">,</span> <span class="n">privateServlet</span><span class="o">);</span>
	<span class="o">}</span>

<span class="o">}</span></code></pre></figure>

<p>Let’s explore the provided objects in more detail:</p>
<ul>
  <li><strong>AuthService</strong> - authorization and register logic</li>
  <li><strong>Executor</strong> - needed for StaticLoader</li>
  <li><a href="https://github.com/activej/activej/blob/v4.3/core-http/src/main/java/io/activej/http/loader/StaticLoader.java"><strong>StaticLoader</strong></a> - loads static content from <code class="language-plaintext highlighter-rouge">/site</code> directory</li>
  <li><a href="https://github.com/activej/activej/blob/v4.3/core-http/src/main/java/io/activej/http/session/SessionStore.java"><strong>SessionStore</strong></a> - handy storage for information about sessions</li>
  <li><a href="https://github.com/activej/activej/blob/v4.3/core-http/src/main/java/io/activej/http/AsyncServlet.java"><strong>AsyncServlet</strong></a> <em>servlet</em> - the main servlet that combines public and private servlets (for authorized and 
unauthorized sessions). As you can see, due to DI, this servlet only requires two servlets without their own dependencies</li>
</ul>

<p>Now let’s provide the <strong>public</strong> and <strong>private</strong> servlets.</p>
<ul>
  <li><strong>AsyncServlet</strong> <em>publicServlet</em> - manages unauthorized sessions:</li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Provides</span>
<span class="nd">@Named</span><span class="o">(</span><span class="s">"public"</span><span class="o">)</span>
<span class="nc">AsyncServlet</span> <span class="nf">publicServlet</span><span class="o">(</span><span class="nc">AuthService</span> <span class="n">authService</span><span class="o">,</span> <span class="nc">SessionStore</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">store</span><span class="o">,</span> <span class="nc">StaticLoader</span> <span class="n">staticLoader</span><span class="o">)</span> <span class="o">{</span>
	<span class="k">return</span> <span class="nc">RoutingServlet</span><span class="o">.</span><span class="na">create</span><span class="o">()</span>
			<span class="c1">//[START REGION_3]</span>
			<span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="s">"/"</span><span class="o">,</span> <span class="n">request</span> <span class="o">-&gt;</span> <span class="nc">HttpResponse</span><span class="o">.</span><span class="na">redirect302</span><span class="o">(</span><span class="s">"/login"</span><span class="o">))</span>
			<span class="c1">//[END REGION_3]</span>
			<span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="no">GET</span><span class="o">,</span> <span class="s">"/signup"</span><span class="o">,</span> <span class="nc">StaticServlet</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">staticLoader</span><span class="o">,</span> <span class="s">"signup.html"</span><span class="o">))</span>
			<span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="no">GET</span><span class="o">,</span> <span class="s">"/login"</span><span class="o">,</span> <span class="nc">StaticServlet</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">staticLoader</span><span class="o">,</span> <span class="s">"login.html"</span><span class="o">))</span>
			<span class="c1">//[START REGION_4]</span>
			<span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="no">POST</span><span class="o">,</span> <span class="s">"/login"</span><span class="o">,</span> <span class="n">loadBody</span><span class="o">()</span>
					<span class="o">.</span><span class="na">serveFirstSuccessful</span><span class="o">(</span>
							<span class="n">request</span> <span class="o">-&gt;</span> <span class="o">{</span>
								<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">params</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getPostParameters</span><span class="o">();</span>
								<span class="nc">String</span> <span class="n">username</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"username"</span><span class="o">);</span>
								<span class="nc">String</span> <span class="n">password</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"password"</span><span class="o">);</span>
								<span class="k">if</span> <span class="o">(</span><span class="n">authService</span><span class="o">.</span><span class="na">authorize</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">))</span> <span class="o">{</span>
									<span class="nc">String</span> <span class="n">sessionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">randomUUID</span><span class="o">().</span><span class="na">toString</span><span class="o">();</span>

									<span class="n">store</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">sessionId</span><span class="o">,</span> <span class="s">"My object saved in session"</span><span class="o">);</span>
									<span class="k">return</span> <span class="nc">HttpResponse</span><span class="o">.</span><span class="na">redirect302</span><span class="o">(</span><span class="s">"/members"</span><span class="o">)</span>
											<span class="o">.</span><span class="na">withCookie</span><span class="o">(</span><span class="nc">HttpCookie</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="no">SESSION_ID</span><span class="o">,</span> <span class="n">sessionId</span><span class="o">));</span>
								<span class="o">}</span>
								<span class="k">return</span> <span class="nc">AsyncServlet</span><span class="o">.</span><span class="na">NEXT</span><span class="o">;</span>
							<span class="o">},</span>
							<span class="nc">StaticServlet</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">staticLoader</span><span class="o">,</span> <span class="s">"errorPage.html"</span><span class="o">)))</span>
			<span class="c1">//[END REGION_4]</span>
			<span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="no">POST</span><span class="o">,</span> <span class="s">"/signup"</span><span class="o">,</span> <span class="n">loadBody</span><span class="o">()</span>
					<span class="o">.</span><span class="na">serve</span><span class="o">(</span><span class="n">request</span> <span class="o">-&gt;</span> <span class="o">{</span>
						<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">params</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getPostParameters</span><span class="o">();</span>
						<span class="nc">String</span> <span class="n">username</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"username"</span><span class="o">);</span>
						<span class="nc">String</span> <span class="n">password</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"password"</span><span class="o">);</span>

						<span class="k">if</span> <span class="o">(</span><span class="n">username</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">password</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
							<span class="n">authService</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
						<span class="o">}</span>
						<span class="k">return</span> <span class="nc">HttpResponse</span><span class="o">.</span><span class="na">redirect302</span><span class="o">(</span><span class="s">"/login"</span><span class="o">);</span>
					<span class="o">}));</span>
<span class="o">}</span></code></pre></figure>

<p>Let’s take a closer look at how we set up routing for servlets. ActiveJ approach resembles Express. For example, 
here’s the request to the homepage for unauthorized users:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="s">"/"</span><span class="o">,</span> <span class="n">request</span> <span class="o">-&gt;</span> <span class="nc">HttpResponse</span><span class="o">.</span><span class="na">redirect302</span><span class="o">(</span><span class="s">"/login"</span><span class="o">))</span></code></pre></figure>

<p>Method <em>map(@Nullable HttpMethod method, String path, AsyncServlet servlet)</em> adds the route to the <a href="https://github.com/activej/activej/blob/v4.3/core-http/src/main/java/io/activej/http/RoutingServlet.java"><strong>RoutingServlet</strong></a>:</p>
<ul>
  <li><em>method</em> (optional) is one of the HTTP methods (<code class="language-plaintext highlighter-rouge">GET</code>, <code class="language-plaintext highlighter-rouge">POST</code>, etc.)</li>
  <li><em>path</em> is the path on the server</li>
  <li><em>servlet</em> defines the logic of request processing. If you need to get some data from the <em>request</em> while processing you can use:
    <ul>
      <li><em>request.getPathParameter(String key)</em>/<em>request.getQueryParameter(String key)</em> (<a href="/http.html#request-parameters-example">see example of query parameter usage</a>) 
  to provide the key of the needed parameter and receive back a corresponding String</li>
      <li><em>request.getPostParameters()</em> to get a Map of all request parameters</li>
    </ul>
  </li>
</ul>

<p><code class="language-plaintext highlighter-rouge">GET</code> requests with paths <strong>“/login”</strong> and <strong>“/signup”</strong> upload the needed HTML pages.
<code class="language-plaintext highlighter-rouge">POST</code> requests with paths <strong>“/login”</strong> and <strong>“/signup”</strong> take care of log in and sign up logic respectively:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="no">POST</span><span class="o">,</span> <span class="s">"/login"</span><span class="o">,</span> <span class="n">loadBody</span><span class="o">()</span>
		<span class="o">.</span><span class="na">serveFirstSuccessful</span><span class="o">(</span>
				<span class="n">request</span> <span class="o">-&gt;</span> <span class="o">{</span>
					<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">params</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getPostParameters</span><span class="o">();</span>
					<span class="nc">String</span> <span class="n">username</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"username"</span><span class="o">);</span>
					<span class="nc">String</span> <span class="n">password</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"password"</span><span class="o">);</span>
					<span class="k">if</span> <span class="o">(</span><span class="n">authService</span><span class="o">.</span><span class="na">authorize</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">))</span> <span class="o">{</span>
						<span class="nc">String</span> <span class="n">sessionId</span> <span class="o">=</span> <span class="no">UUID</span><span class="o">.</span><span class="na">randomUUID</span><span class="o">().</span><span class="na">toString</span><span class="o">();</span>

						<span class="n">store</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">sessionId</span><span class="o">,</span> <span class="s">"My object saved in session"</span><span class="o">);</span>
						<span class="k">return</span> <span class="nc">HttpResponse</span><span class="o">.</span><span class="na">redirect302</span><span class="o">(</span><span class="s">"/members"</span><span class="o">)</span>
								<span class="o">.</span><span class="na">withCookie</span><span class="o">(</span><span class="nc">HttpCookie</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="no">SESSION_ID</span><span class="o">,</span> <span class="n">sessionId</span><span class="o">));</span>
					<span class="o">}</span>
					<span class="k">return</span> <span class="nc">AsyncServlet</span><span class="o">.</span><span class="na">NEXT</span><span class="o">;</span>
				<span class="o">},</span>
				<span class="nc">StaticServlet</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">staticLoader</span><span class="o">,</span> <span class="s">"errorPage.html"</span><span class="o">)))</span></code></pre></figure>

<p>Pay attention at <code class="language-plaintext highlighter-rouge">POST</code> <strong>“/login”</strong> route. <em>serveFirstSuccessful()</em> takes two servlets and waits until one of them 
finishes processing successfully. So if authorization fails, a Promise of <strong>null</strong> will be returned (<strong>AsyncServlet.NEXT</strong>), 
which means fail. In this case, a simple <strong>StaticServlet</strong> will be created to load the <em>errorPage</em>. 
Successful log in will generate a session <em>id</em> for the user and will save string <code class="language-plaintext highlighter-rouge">"My saved object in session"</code> to session store. 
Also it will redirect user to <strong>“/members”</strong>.</p>

<p>Now, let’s get to the next servlet that handles authorized sessions.</p>
<ul>
  <li><strong>AsyncServlet</strong> <em>privateServlet</em> - manages authorized sessions:</li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Provides</span>
<span class="nd">@Named</span><span class="o">(</span><span class="s">"private"</span><span class="o">)</span>
<span class="nc">AsyncServlet</span> <span class="nf">privateServlet</span><span class="o">(</span><span class="nc">StaticLoader</span> <span class="n">staticLoader</span><span class="o">)</span> <span class="o">{</span>
	<span class="k">return</span> <span class="nc">RoutingServlet</span><span class="o">.</span><span class="na">create</span><span class="o">()</span>
			<span class="c1">//[START REGION_6]</span>
			<span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="s">"/"</span><span class="o">,</span> <span class="n">request</span> <span class="o">-&gt;</span> <span class="nc">HttpResponse</span><span class="o">.</span><span class="na">redirect302</span><span class="o">(</span><span class="s">"/members"</span><span class="o">))</span>
			<span class="c1">//[END REGION_6]</span>
			<span class="c1">//[START REGION_7]</span>
			<span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="s">"/members/*"</span><span class="o">,</span> <span class="nc">RoutingServlet</span><span class="o">.</span><span class="na">create</span><span class="o">()</span>
					<span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="no">GET</span><span class="o">,</span> <span class="s">"/"</span><span class="o">,</span> <span class="nc">StaticServlet</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">staticLoader</span><span class="o">,</span> <span class="s">"index.html"</span><span class="o">))</span>
					<span class="c1">//[START REGION_8]</span>
					<span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="no">GET</span><span class="o">,</span> <span class="s">"/cookie"</span><span class="o">,</span> <span class="n">request</span> <span class="o">-&gt;</span>
							<span class="nc">HttpResponse</span><span class="o">.</span><span class="na">ok200</span><span class="o">().</span><span class="na">withBody</span><span class="o">(</span><span class="n">wrapUtf8</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getAttachment</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">))))</span>
					<span class="c1">//[END REGION_8]</span>
					<span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="no">POST</span><span class="o">,</span> <span class="s">"/logout"</span><span class="o">,</span> <span class="n">request</span> <span class="o">-&gt;</span>
							<span class="nc">HttpResponse</span><span class="o">.</span><span class="na">redirect302</span><span class="o">(</span><span class="s">"/"</span><span class="o">)</span>
									<span class="o">.</span><span class="na">withCookie</span><span class="o">(</span><span class="nc">HttpCookie</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="no">SESSION_ID</span><span class="o">).</span><span class="na">withPath</span><span class="o">(</span><span class="s">"/"</span><span class="o">).</span><span class="na">withMaxAge</span><span class="o">(</span><span class="nc">Duration</span><span class="o">.</span><span class="na">ZERO</span><span class="o">))));</span>
	<span class="c1">//[END REGION_7]</span>
<span class="o">}</span></code></pre></figure>

<p>First, it redirects requests from homepage to <strong>“/members”</strong>:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="s">"/"</span><span class="o">,</span> <span class="n">request</span> <span class="o">-&gt;</span> <span class="nc">HttpResponse</span><span class="o">.</span><span class="na">redirect302</span><span class="o">(</span><span class="s">"/members"</span><span class="o">))</span></code></pre></figure>

<p>Next, it takes care of all of the requests that go after <strong>“/members”</strong> path:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="s">"/members/*"</span><span class="o">,</span> <span class="nc">RoutingServlet</span><span class="o">.</span><span class="na">create</span><span class="o">()</span>
		<span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="no">GET</span><span class="o">,</span> <span class="s">"/"</span><span class="o">,</span> <span class="nc">StaticServlet</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">staticLoader</span><span class="o">,</span> <span class="s">"index.html"</span><span class="o">))</span>
		<span class="c1">//[START REGION_8]</span>
		<span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="no">GET</span><span class="o">,</span> <span class="s">"/cookie"</span><span class="o">,</span> <span class="n">request</span> <span class="o">-&gt;</span>
				<span class="nc">HttpResponse</span><span class="o">.</span><span class="na">ok200</span><span class="o">().</span><span class="na">withBody</span><span class="o">(</span><span class="n">wrapUtf8</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getAttachment</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">))))</span>
		<span class="c1">//[END REGION_8]</span>
		<span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="no">POST</span><span class="o">,</span> <span class="s">"/logout"</span><span class="o">,</span> <span class="n">request</span> <span class="o">-&gt;</span>
				<span class="nc">HttpResponse</span><span class="o">.</span><span class="na">redirect302</span><span class="o">(</span><span class="s">"/"</span><span class="o">)</span>
						<span class="o">.</span><span class="na">withCookie</span><span class="o">(</span><span class="nc">HttpCookie</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="no">SESSION_ID</span><span class="o">).</span><span class="na">withPath</span><span class="o">(</span><span class="s">"/"</span><span class="o">).</span><span class="na">withMaxAge</span><span class="o">(</span><span class="nc">Duration</span><span class="o">.</span><span class="na">ZERO</span><span class="o">))));</span></code></pre></figure>

<p>Pay attention to the path <strong>“/members/*“</strong>.
<code class="language-plaintext highlighter-rouge">*</code> is a variable for the next part of the path. It states that this servlet will process any path segment that goes after <strong>“/members/”</strong>.
For example, this route:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="no">GET</span><span class="o">,</span> <span class="s">"/cookie"</span><span class="o">,</span> <span class="n">request</span> <span class="o">-&gt;</span>
		<span class="nc">HttpResponse</span><span class="o">.</span><span class="na">ok200</span><span class="o">().</span><span class="na">withBody</span><span class="o">(</span><span class="n">wrapUtf8</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getAttachment</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">))))</span></code></pre></figure>

<p>is a GET request for <strong>“/members/cookie”</strong> path. This request shows all cookies stored in the session.</p>

<div class="note-wrapper">
    <div class="note">
        <b>Note:</b>
        A request can have an attachment map where any content can be mapped to some type, i.e. String. 
<br />By default, requests have no attachments. 
<br />In this case, the request contains 'cookies' as an attachment that's mapped to the `String` type.
    </div>
</div>

<p><strong>“/members/logout”</strong> logs the user out, deletes all cookies related to this session and redirects the user to the homepage.</p>

<p>After <strong>public</strong> and <strong>private</strong> servlets are set up, we define <code class="language-plaintext highlighter-rouge">main()</code> method, which will start our launcher:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
	<span class="nc">AuthLauncher</span> <span class="n">launcher</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AuthLauncher</span><span class="o">();</span>
	<span class="n">launcher</span><span class="o">.</span><span class="na">launch</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure>

<h2 id="running-the-application">Running the application</h2>
<p>If you want to run the example, <a href="https://github.com/activej/activej">clone ActiveJ</a> and import it 
as a Maven project. Check out branch <strong>v4.3</strong>. Before running the example, build the project (<strong>Ctrl + F9</strong> for IntelliJ IDEA).</p>

<p>Open <code class="language-plaintext highlighter-rouge">AuthLauncher</code> class and run its <em>main()</em> method.
Then open your favorite browser and go to <a href="http://localhost:8080" data-proofer-ignore="true">localhost:8080</a>. Try to sign up and then log in. When 
logged in, check out your saved cookies for session. You will see the following content: <code class="language-plaintext highlighter-rouge">My saved object in session</code>. 
Finally, try to log out. You can also try to log in with an invalid login or password.</p>

    <div class="row docs-prevnext">
        
            <div class="col-sm-6">
                <a class="docs-prevnext__button pull-left" href="http-decoder.html">Prev</a>
            </div>
        
        
            <div class="col-sm-6">
                <a class="docs-prevnext__button pull-right" href="getting-started-advanced.html">Next</a>
            </div>
        
    </div>
</div>


                </div>
            </div>
        
        <div class="container justify-content-between footer">
            <div class="col-md-4 col-lg-5"> &copy; 2021 ActiveJ LLC. All Rights Reserved</div>
            <div class="col-md-4 col-lg-3">Contact us: contact@activej.io</div>
            <div class="col-md-8 col-lg-4 footer__menu">
                <a href="http://uikernel.io">UIKernel</a>
                <a href="https://adkernel.com">AdKernel</a>
                <a href="https://github.com/activej/activej">GitHub</a>
            </div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/TweenMax.min.js"></script>
    <script src="../static/js/leon.js"></script>
    <script src="../static/js/index.js"></script>
    <script
        src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous">
    </script>
</body>
</html>
