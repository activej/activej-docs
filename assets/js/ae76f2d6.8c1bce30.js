"use strict";(self.webpackChunkactivejdocs=self.webpackChunkactivejdocs||[]).push([[77],{3905:function(e,t,a){a.d(t,{Zo:function(){return m},kt:function(){return d}});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},m=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),c=p(a),d=r,h=c["".concat(s,".").concat(d)]||c[d]||u[d]||l;return a?n.createElement(h,i(i({ref:t},m),{},{components:a})):n.createElement(h,i({ref:t},m))}));function d(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,i=new Array(l);i[0]=c;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,i[1]=o;for(var p=2;p<l;p++)i[p]=a[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},77618:function(e,t,a){var n=a(67294),r=a(39962);t.Z=function(e){var t=e.url,a=e.text,l=e.isInline,i=void 0===l||l,o=e.children,s=(0,r.Z)().siteConfig,p=t.startsWith("/examples")?s.customFields.githubExamplesBranch:s.customFields.githubBranch;return n.createElement("a",{style:i?{}:{display:"block",marginBottom:"16px"},href:s.customFields.githubUrl+"/"+p+t,target:"_blank"},a||o)}},77815:function(e,t,a){a(67294);var n=a(39962);t.Z=function(e){var t=e.name,a=(0,n.Z)().siteConfig;if(!t)throw new Error("Variable name is required");if(void 0===a.customFields[t])throw new Error("Variable "+t+" not exist");return a.customFields[t]}},69415:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return p},contentTitle:function(){return m},metadata:function(){return u},toc:function(){return c},default:function(){return h}});var n=a(83117),r=a(80102),l=(a(67294),a(3905)),i=a(77618),o=a(77815),s=["components"],p={sidebar_label:"Examples"},m="Examples",u={unversionedId:"http/examples",id:"http/examples",isDocsHomePage:!1,title:"Examples",description:'* Simple "Hello World" Server - a simple asynchronous server created using',source:"@site/docs/http/examples.mdx",sourceDirName:"http",slug:"/http/examples",permalink:"/http/examples",tags:[],version:"current",frontMatter:{sidebar_label:"Examples"},sidebar:"docs",previous:{title:"Benchmarks",permalink:"/http/benchmarks"},next:{title:"Overview",permalink:"/inject"}},c=[{value:"Simple &quot;Hello World&quot; Server",id:"simple-hello-world-server",children:[],level:3},{value:"&quot;Hello World&quot; Server with pre-defined Launcher",id:"hello-world-server-with-pre-defined-launcher",children:[],level:3},{value:"Custom Server",id:"custom-server",children:[],level:3},{value:"Multithreaded Server Example",id:"multithreaded-server-example",children:[],level:3},{value:"Request Parameters Example",id:"request-parameters-example",children:[],level:3},{value:"Static Servlet Example",id:"static-servlet-example",children:[],level:3},{value:"Routing Servlet Example",id:"routing-servlet-example",children:[],level:3},{value:"Dynamic Routing Examples",id:"dynamic-routing-examples",children:[],level:3},{value:"Routing Servlet Multibinder",id:"routing-servlet-multibinder",children:[],level:3},{value:"Blocking Servlet Example",id:"blocking-servlet-example",children:[],level:3},{value:"File Upload Example",id:"file-upload-example",children:[],level:3},{value:"Client Example",id:"client-example",children:[],level:3},{value:"Multipart Data Handling Example",id:"multipart-data-handling-example",children:[],level:3},{value:"WebSocket Pong Server",id:"websocket-pong-server",children:[],level:3},{value:"WebSocket Ping Client",id:"websocket-ping-client",children:[],level:3}],d={toc:c};function h(e){var t=e.components,a=(0,r.Z)(e,s);return(0,l.kt)("wrapper",(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"examples"},"Examples"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#simple-hello-world-server"},'Simple "Hello World" Server')," - a simple asynchronous server created using ",(0,l.kt)(i.Z,{text:"HttpServer",url:"/core-http/src/main/java/io/activej/http/HttpServer.java",mdxType:"Githublink"})),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#hello-world-server-with-pre-defined-launcher"},'"Hello World" Server with Pre-defined Launcher')," - HTTP module provides you with some pre-defined launchers, which are very easy to use for creating servers."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#custom-server"},"Custom Server")," - example of creating a server from scratch using ",(0,l.kt)("a",{parentName:"li",href:"/boot/launcher"},(0,l.kt)("strong",{parentName:"a"},"Launcher")),"."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#multithreaded-server-example"},"Multithreaded Server Example")," - HTTP multithreaded server example."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#request-parameters-example"},"Request Parameters Example")," - example of processing requests with parameter."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#static-servlet-example"},"Static Servlet Example")," - example of ",(0,l.kt)(i.Z,{text:"StaticServlet",url:"/core-http/src/main/java/io/activej/http/StaticServlet.java",mdxType:"Githublink"})," utilizing"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#routing-servlet-example"},"Routing Servlet Example")," - example of ",(0,l.kt)("inlineCode",{parentName:"li"},"RoutingServlet")," usage for creating servlet tree."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#dynamic-routing-examples"},"Dynamic Routing Examples")," - various examples of routing based on host, cookie, mime-type, etc."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#routing-servlet-multibinder"},"Routing Servlet Multibinder")," - example of using ",(0,l.kt)("strong",{parentName:"li"},"Multibinder")," to merge conflicting ",(0,l.kt)("inlineCode",{parentName:"li"},"RoutingServlet"),"s"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#blocking-servlet-example"},"Blocking Servlet Example")," - example of handling complex operations on server in a new thread."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#file-upload-example"},"File Upload Example")," - example of uploading a file from client local storage to server."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#client-example"},"Client Example")," - creating an HTTP client utilizing ",(0,l.kt)("strong",{parentName:"li"},"Launcher"),"."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#multipart-data-handling-example"},"Multipart Data Handling Example")," - simple server that handles ",(0,l.kt)("strong",{parentName:"li"},"Multipart/form-data")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#websocket-pong-server"},"WebSocket Echo Server Example")," - creating a basic server with WebSocket communication protocol."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"#websocket-ping-client"},"WebSocket Client Example")," - setting up a client with WebSocket communication protocol.")),(0,l.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"To run the examples, you need to clone ActiveJ from GitHub:"),(0,l.kt)("pre",{parentName:"div"},(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"git clone https://github.com/activej/activej\n")),(0,l.kt)("p",{parentName:"div"},"And import it as a Maven project. Check out tag ",(0,l.kt)("strong",{parentName:"p"},(0,l.kt)(o.Z,{name:"currentVersion",mdxType:"Variable"})),". Before running the examples, build the project. These examples are located at ",(0,l.kt)("inlineCode",{parentName:"p"},"activej/examples/core/http")))),(0,l.kt)("h3",{id:"simple-hello-world-server"},'Simple "Hello World" Server'),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"#"},(0,l.kt)(i.Z,{url:"/examples/core/http/src/main/java/HelloWorldExample.java",mdxType:"Githublink"},"HelloWorldExample"))," uses the ",(0,l.kt)("strong",{parentName:"p"},"HttpServer")," class of the HTTP module. It is a non-blocking server that runs in an eventloop reactor:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java",metastring:"url=/examples/core/http/src/main/java/HelloWorldExample.java tag=REGION_1",url:"/examples/core/http/src/main/java/HelloWorldExample.java",tag:"REGION_1"},'\npublic static void main(String[] args) throws IOException {\n  Eventloop eventloop = Eventloop.create();\n  HttpServer server = HttpServer.builder(eventloop,\n      request -> HttpResponse.ok200()\n        .withPlainText("Hello world!")\n        .toPromise())\n    .withListenPort(8080)\n    .build();\n\n  server.listen();\n\n  System.out.println("Server is running");\n  System.out.println("You can connect from browser by visiting \'http://localhost:8080/\'");\n\n  eventloop.run();\n}\n')),(0,l.kt)("p",null,"This server runs in the provided eventloop and waits for connections on port ",(0,l.kt)("inlineCode",{parentName:"p"},"8080"),". When the server receives a request, it sends back a ",(0,l.kt)("strong",{parentName:"p"},"Promise")," of greeting response."),(0,l.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"To add support for HTTPS to ",(0,l.kt)("inlineCode",{parentName:"p"},"HttpServer")," you need to call ",(0,l.kt)("inlineCode",{parentName:"p"},"withSslListenAddress")," or ",(0,l.kt)("inlineCode",{parentName:"p"},"withSslListenAddresses")," builder method and pass ",(0,l.kt)("inlineCode",{parentName:"p"},"SSLContext"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"Executor"),", and a port or address for the server to be listening on."))),(0,l.kt)("p",null,"To check how the example works, open your favorite browser and go to ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:8080"},"localhost:8080"),"."),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"#"},(0,l.kt)(i.Z,{isInline:!1,url:"/examples/core/http/src/main/java/HelloWorldExample.java",mdxType:"Githublink"},"See full example on GitHub"))),(0,l.kt)("h3",{id:"hello-world-server-with-pre-defined-launcher"},'"Hello World" Server with pre-defined Launcher'),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Launcher"),"s manage the lifecycle of applications and allow you to create applications in a simple way:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java",metastring:"url=/examples/tutorials/getting-started/src/main/java/HttpHelloWorldExample.java tag=EXAMPLE",url:"/examples/tutorials/getting-started/src/main/java/HttpHelloWorldExample.java",tag:"EXAMPLE"},'public final class HttpHelloWorldExample extends HttpServerLauncher {\n  @Provides\n  AsyncServlet servlet() {\n    return request -> HttpResponse.ok200()\n      .withPlainText("Hello World")\n      .toPromise();\n  }\n\n  public static void main(String[] args) throws Exception {\n    Launcher launcher = new HttpHelloWorldExample();\n    launcher.launch(args);\n  }\n}\n')),(0,l.kt)("p",null,"All you have to do is provide a servlet that handles the requests and launch the application. ",(0,l.kt)(i.Z,{text:"HttpServerLauncher",url:"/launchers/http/src/main/java/io/activej/launchers/http/HttpServerLauncher.java",mdxType:"Githublink"}),"  will take care of the rest."),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"#"},(0,l.kt)(i.Z,{text:"See full example on GitHub",url:"/examples/tutorials/getting-started/src/main/java/HttpHelloWorldExample.java",mdxType:"Githublink"}))),(0,l.kt)("h3",{id:"custom-server"},"Custom Server"),(0,l.kt)("p",null,"With ",(0,l.kt)("strong",{parentName:"p"},"Launcher")," you can easily create HTTP servers from scratch. In this example, we create a simple server that\nsends a greeting:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java",metastring:"url=/examples/core/http/src/main/java/CustomHttpServerExample.java tag=EXAMPLE",url:"/examples/core/http/src/main/java/CustomHttpServerExample.java",tag:"EXAMPLE"},'public final class CustomHttpServerExample extends Launcher {\n  private static final int PORT = 8080;\n\n  @Provides\n  NioReactor reactor() {\n    return Eventloop.create();\n  }\n\n  @Provides\n  AsyncServlet servlet() {\n    return request -> HttpResponse.ok200()\n      .withPlainText("Hello from HTTP server")\n      .toPromise();\n  }\n\n  @Provides\n  @Eager\n  HttpServer server(NioReactor reactor, AsyncServlet servlet) {\n    return HttpServer.builder(reactor, servlet)\n      .withListenPort(PORT)\n      .build();\n  }\n\n  @Override\n  protected Module getModule() {\n    return ServiceGraphModule.create();\n  }\n\n  @Override\n  protected void run() throws Exception {\n    logger.info("HTTP Server is now available at http://localhost:" + PORT);\n    awaitShutdown();\n  }\n\n  public static void main(String[] args) throws Exception {\n    Launcher launcher = new CustomHttpServerExample();\n    launcher.launch(args);\n  }\n}\n')),(0,l.kt)("p",null,"First, we provide a reactor, a servlet, and a reactive server itself. Then, we override ",(0,l.kt)("em",{parentName:"p"},"getModule")," method to provide\nour server with configs and ",(0,l.kt)(i.Z,{text:"ServiceGraphModule",url:"/boot-servicegraph/src/main/java/io/activej/service/ServiceGraphModule.java",mdxType:"Githublink"})," to build the service dependency graph."),(0,l.kt)("p",null,"Finally, we override the ",(0,l.kt)("inlineCode",{parentName:"p"},"Launcher"),"'s main method ",(0,l.kt)("inlineCode",{parentName:"p"},"run()")," and then define the ",(0,l.kt)("inlineCode",{parentName:"p"},"main")," method of the example."),(0,l.kt)("p",null,"To check how the example works, open your favorite browser and go to ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:8080"},"localhost:8080")),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"#"},(0,l.kt)(i.Z,{isInline:!1,text:"See full example on GitHub",url:"/examples/core/http/src/main/java/CustomHttpServerExample.java",mdxType:"Githublink"}))),(0,l.kt)("h3",{id:"multithreaded-server-example"},"Multithreaded Server Example"),(0,l.kt)("p",null,"In this example we use the predefined ",(0,l.kt)(i.Z,{text:"MultithreadedHttpServerLauncher",url:"/launchers/http/src/main/java/io/activej/launchers/http/MultithreadedHttpServerLauncher.java",mdxType:"Githublink"})," to create a multithreaded HTTP server. By\ndefault, there will be 4 worker servlets with ",(0,l.kt)("em",{parentName:"p"},"workerId"),"s. Each of them sends back a greeting and the number of the worker\nthat served the connection:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java",metastring:"url=/examples/core/http/src/main/java/MultithreadedHttpServerExample.java tag=EXAMPLE",url:"/examples/core/http/src/main/java/MultithreadedHttpServerExample.java",tag:"EXAMPLE"},'public final class MultithreadedHttpServerExample extends MultithreadedHttpServerLauncher {\n  @Provides\n  @Worker\n  AsyncServlet servlet(@WorkerId int workerId) {\n    return request -> HttpResponse.ok200()\n      .withPlainText("Hello from worker server #" + workerId + "\\n")\n      .toPromise();\n  }\n\n  public static void main(String[] args) throws Exception {\n    MultithreadedHttpServerExample example = new MultithreadedHttpServerExample();\n    example.launch(args);\n  }\n}\n')),(0,l.kt)("p",null,"To check how the example works, open your favorite browser and go to ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:8080"},"localhost:8080")),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"#"},(0,l.kt)(i.Z,{isInline:!1,text:"See full example on GitHub",url:"/examples/core/http/src/main/java/MultithreadedHttpServerExample.java",mdxType:"Githublink"}))),(0,l.kt)("h3",{id:"request-parameters-example"},"Request Parameters Example"),(0,l.kt)("p",null,"This example demonstrates handling of requests with parameters which are received with methods ",(0,l.kt)("inlineCode",{parentName:"p"},"getPostParameters")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"getQueryParameter")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java",metastring:"url=/examples/core/http/src/main/java/HttpRequestParametersExample.java tag=REGION_1",url:"/examples/core/http/src/main/java/HttpRequestParametersExample.java",tag:"REGION_1"},'@Provides\nIStaticLoader staticLoader(Reactor reactor, Executor executor) {\n  return IStaticLoader.ofClassPath(reactor, executor, RESOURCE_DIR);\n}\n\n@Provides\nAsyncServlet servlet(Reactor reactor, IStaticLoader staticLoader) {\n  return RoutingServlet.builder(reactor)\n    .with(POST, "/hello", request -> request.loadBody()\n      .then($ -> {\n        String name = request.getPostParameters().get("name");\n        return HttpResponse.ok200()\n          .withHtml("<h1><center>Hello from POST, " + name + "!</center></h1>")\n          .toPromise();\n      }))\n    .with(GET, "/hello", request -> {\n      String name = request.getQueryParameter("name");\n      return HttpResponse.ok200()\n        .withHtml("<h1><center>Hello from GET, " + name + "!</center></h1>")\n        .toPromise();\n    })\n    .with("/*", StaticServlet.builder(reactor, staticLoader)\n      .withIndexHtml()\n      .build())\n    .build();\n}\n')),(0,l.kt)("p",null,"To check how the example works, open your favorite browser and go to ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:8080"},"localhost:8080")),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"#"},(0,l.kt)(i.Z,{isInline:!1,text:"See full example on GitHub",url:"/examples/core/http/src/main/java/HttpRequestParametersExample.java",mdxType:"Githublink"}))),(0,l.kt)("h3",{id:"static-servlet-example"},"Static Servlet Example"),(0,l.kt)("p",null,"Shows how to set up and utilize ",(0,l.kt)(i.Z,{text:"StaticServlet",url:"/examples/core/http/src/main/java/HttpRequestParametersExample.java",mdxType:"Githublink"})," to create servlets with some static content, in our case it will get\ncontent from the ",(0,l.kt)("inlineCode",{parentName:"p"},"static/site")," directory."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java",metastring:"url=/examples/core/http/src/main/java/StaticServletExample.java tag=EXAMPLE",url:"/examples/core/http/src/main/java/StaticServletExample.java",tag:"EXAMPLE"},'@Provides\nIStaticLoader staticLoader(Reactor reactor, Executor executor) {\n  return IStaticLoader.ofClassPath(reactor, executor, "static/site");\n}\n\n@Provides\nAsyncServlet servlet(Reactor reactor, IStaticLoader staticLoader) {\n  return StaticServlet.builder(reactor, staticLoader)\n    .withIndexHtml()\n    .build();\n}\n')),(0,l.kt)("p",null,"To check how the example works, open your favorite browser and go to ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:8080"},"localhost:8080")),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"#"},(0,l.kt)(i.Z,{isInline:!1,text:"See full example on GitHub",url:"/examples/core/http/src/main/java/StaticServletExample.java",mdxType:"Githublink"}))),(0,l.kt)("h3",{id:"routing-servlet-example"},"Routing Servlet Example"),(0,l.kt)("p",null,"Represents how to set up servlet routing tree. This process resembles Express approach. To add a route to a ",(0,l.kt)(i.Z,{text:"RoutingServlet",url:"/core-http/src/main/java/io/activej/http/RoutingServlet.java",mdxType:"Githublink"}),", you should use method ",(0,l.kt)("inlineCode",{parentName:"p"},"with")," of ",(0,l.kt)("inlineCode",{parentName:"p"},"RoutingServet"),"'s builder:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java",metastring:"url=/examples/core/http/src/main/java/RoutingServletExample.java tag=REGION_2",url:"/examples/core/http/src/main/java/RoutingServletExample.java",tag:"REGION_2"},'.with(GET, "/", request ->\n  HttpResponse.ok200()\n    .withHtml("""\n      <h1>Go to some pages</h1>\n      <a href="/path1"> Path 1 </a><br>\n      <a href="/path2"> Path 2 </a><br>\n      <a href="/user/0"> Data for user with ID 0 </a><br>\n      <br>\n      <a href="/path3"> Non existent </a>\n      """)\n    .toPromise())\n')),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("em",{parentName:"li"},"method")," (optional) is one of the HTTP methods (",(0,l.kt)("inlineCode",{parentName:"li"},"GET"),", ",(0,l.kt)("inlineCode",{parentName:"li"},"POST"),", etc)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("em",{parentName:"li"},"path")," is the path on the server"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("em",{parentName:"li"},"servlet")," defines the logic of request processing.")),(0,l.kt)("p",null,"The whole servlet tree will look as follows:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java",metastring:"url=/examples/core/http/src/main/java/RoutingServletExample.java tag=REGION_1",url:"/examples/core/http/src/main/java/RoutingServletExample.java",tag:"REGION_1"},'@Provides\nAsyncServlet servlet(Reactor reactor) {\n  return RoutingServlet.builder(reactor)\n    //[START REGION_2]\n    .with(GET, "/", request ->\n      HttpResponse.ok200()\n        .withHtml("""\n          <h1>Go to some pages</h1>\n          <a href="/path1"> Path 1 </a><br>\n          <a href="/path2"> Path 2 </a><br>\n          <a href="/user/0"> Data for user with ID 0 </a><br>\n          <br>\n          <a href="/path3"> Non existent </a>\n          """)\n        .toPromise())\n    //[END REGION_2]\n    .with(GET, "/path1", request ->\n      HttpResponse.ok200()\n        .withHtml("""\n          <h1>Hello from the first path!</h1>\n          <a href="/">Go home</a>\n          """)\n        .toPromise())\n    .with(GET, "/path2", request ->\n      HttpResponse.ok200()\n        .withHtml("""\n          <h1>Hello from the second path!</h1>\n          <a href="/">Go home</a>\n          """)\n        .toPromise())\n\n    //[START REGION_3]\n    .with(GET, "/user/:user_id", request -> {\n      String userId = request.getPathParameter("user_id");\n      return HttpResponse.ok200()\n        .withHtml("""\n          <h1>You have requested data for user with ID: $userId</h1>\n          <h3>Try changing URL after <i>\'.../user/\'</i> to get data for users with different IDs</h3>\n          """\n          .replace("$userId", userId))\n        .toPromise();\n    })\n    //[END REGION_3]\n\n    //[START REGION_4]\n    .with("/*", request ->\n      HttpResponse.ofCode(404)\n        .withHtml("""\n          <h1>404</h1><p>Path \'$path\' not found</p>\n          <a href="/">Go home</a>\n          """\n          .replace("$path", request.getRelativePath()))\n        .toPromise())\n    .build();\n  //[END REGION_4]\n}\n')),(0,l.kt)("p",null,"You can map path parameters with ",(0,l.kt)("inlineCode",{parentName:"p"},"/:param")," syntax:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java",metastring:"url=/examples/core/http/src/main/java/RoutingServletExample.java tag=REGION_3",url:"/examples/core/http/src/main/java/RoutingServletExample.java",tag:"REGION_3"},'.with(GET, "/user/:user_id", request -> {\n  String userId = request.getPathParameter("user_id");\n  return HttpResponse.ok200()\n    .withHtml("""\n      <h1>You have requested data for user with ID: $userId</h1>\n      <h3>Try changing URL after <i>\'.../user/\'</i> to get data for users with different IDs</h3>\n      """\n      .replace("$userId", userId))\n    .toPromise();\n})\n')),(0,l.kt)("p",null,"Path parameters can be retrieved by calling ",(0,l.kt)("inlineCode",{parentName:"p"},"HttpRequest#getPathParameter")," method and passing the name of the path parameter."),(0,l.kt)("p",null,"You may also use wildcard route ",(0,l.kt)("inlineCode",{parentName:"p"},"*"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java",metastring:"url=/examples/core/http/src/main/java/RoutingServletExample.java tag=REGION_4",url:"/examples/core/http/src/main/java/RoutingServletExample.java",tag:"REGION_4"},'.with("/*", request ->\n  HttpResponse.ofCode(404)\n    .withHtml("""\n      <h1>404</h1><p>Path \'$path\' not found</p>\n      <a href="/">Go home</a>\n      """\n      .replace("$path", request.getRelativePath()))\n    .toPromise())\n.build();\n')),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"*")," states that whichever next path segment is received, it will be processed by this servlet."),(0,l.kt)("p",null,"To check how the example works, open your favorite browser and go to ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:8080"},"localhost:8080")),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"#"},(0,l.kt)(i.Z,{isInline:!1,text:"See full example on GitHub",url:"/examples/core/http/src/main/java/RoutingServletExample.java",mdxType:"Githublink"}))),(0,l.kt)("h3",{id:"dynamic-routing-examples"},"Dynamic Routing Examples"),(0,l.kt)("p",null,"A few examples that demonstrate how to route HTTP requests by some dynamic values rather than by predefined paths:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)(i.Z,{text:"Routing based on host",url:"/examples/core/http/src/main/java/HostRoutingExample.java",mdxType:"Githublink"})),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)(i.Z,{text:"Routing based on MIME type",url:"/examples/core/http/src/main/java/MimeTypeRoutingExample.java",mdxType:"Githublink"})),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)(i.Z,{text:"Routing based on Cookie",url:"/examples/core/http/src/main/java/CookieRoutingExample.java",mdxType:"Githublink"})),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)(i.Z,{text:"Randomized routing",url:"/examples/core/http/src/main/java/DynamicRoutingExample.java",mdxType:"Githublink"}))),(0,l.kt)("h3",{id:"routing-servlet-multibinder"},"Routing Servlet Multibinder"),(0,l.kt)("p",null,"Using ",(0,l.kt)("a",{parentName:"p",href:"/inject"},"Dependency Injection")," you can provide ",(0,l.kt)("inlineCode",{parentName:"p"},"RoutingServlet"),"s in different modules.\nSuch bindings would result in ",(0,l.kt)("strong",{parentName:"p"},"DI")," throwing an exception because of conflicting ",(0,l.kt)("inlineCode",{parentName:"p"},"RoutingServlet.class")," keys. However, you can instruct the ",(0,l.kt)("strong",{parentName:"p"},"DI")," to resolve conflicts by merging ",(0,l.kt)("inlineCode",{parentName:"p"},"RoutingServlet"),"s into a single ",(0,l.kt)("inlineCode",{parentName:"p"},"RoutingServlet")," that contains all the routes specified in other routing servlets."),(0,l.kt)("p",null,"In the example we declare several modules that provide ",(0,l.kt)("inlineCode",{parentName:"p"},"RoutingServlet")," with different routes:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java",metastring:"url=/examples/core/http/src/main/java/RoutingServletMultibinderExample.java tag=MODULE_A",url:"/examples/core/http/src/main/java/RoutingServletMultibinderExample.java",tag:"MODULE_A"},'private static final class ModuleA extends AbstractModule {\n  @Provides\n  RoutingServlet servlet(Reactor reactor) {\n    return RoutingServlet.builder(reactor)\n      .with(GET, "/a", request -> HttpResponse.ok200()\n        .withPlainText("Hello from \'/a\' path\\n")\n        .toPromise())\n      .with(GET, "/b", request -> HttpResponse.ok200()\n        .withPlainText("Hello from \'/b\' path\\n")\n        .toPromise())\n      .with(GET, "/", request -> HttpResponse.ok200()\n        .withPlainText("Hello from \'/\' path\\n")\n        .toPromise())\n      .build();\n  }\n}\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java",metastring:"url=/examples/core/http/src/main/java/RoutingServletMultibinderExample.java tag=MODULE_B",url:"/examples/core/http/src/main/java/RoutingServletMultibinderExample.java",tag:"MODULE_B"},'private static final class ModuleB extends AbstractModule {\n  @Provides\n  RoutingServlet servlet(Reactor reactor) {\n    return RoutingServlet.builder(reactor)\n      .with(GET, "/a/b", request -> HttpResponse.ok200()\n        .withPlainText("Hello from \'/a/b\' path\\n")\n        .toPromise())\n      .with(GET, "/b/a", request -> HttpResponse.ok200()\n        .withPlainText("Hello from \'/b/a\' path\\n")\n        .toPromise())\n      .with(GET, "/d", request -> HttpResponse.ok200()\n        .withPlainText("Hello from \'/d\' path\\n")\n        .toPromise())\n      .build();\n  }\n}\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java",metastring:"url=/examples/core/http/src/main/java/RoutingServletMultibinderExample.java tag=MODULE_C",url:"/examples/core/http/src/main/java/RoutingServletMultibinderExample.java",tag:"MODULE_C"},'private static final class ModuleC extends AbstractModule {\n  @Provides\n  RoutingServlet servlet(Reactor reactor) {\n    return RoutingServlet.builder(reactor)\n      .with(GET, "/a/c", request -> HttpResponse.ok200()\n        .withPlainText("Hello from \'/a/c\' path\\n")\n        .toPromise())\n      .with(GET, "/b/c", request -> HttpResponse.ok200()\n        .withPlainText("Hello from \'/b/c\' path\\n")\n        .toPromise())\n      .with(POST, "/d", request -> HttpResponse.ok200()\n        .withPlainText("Hello from POST \'/d\' path\\n")\n        .toPromise())\n      .build();\n  }\n}\n')),(0,l.kt)("p",null,"Next, we define a ",(0,l.kt)(i.Z,{text:"Multibinder",url:"/core-inject/src/main/java/io/activej/inject/binding/Multibinder.java",mdxType:"Githublink"}),"\nwhich merges conflicting servlets:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java",metastring:"url=/examples/core/http/src/main/java/RoutingServletMultibinderExample.java tag=MULTIBINDER",url:"/examples/core/http/src/main/java/RoutingServletMultibinderExample.java",tag:"MULTIBINDER"},"public static final Multibinder<RoutingServlet> SERVLET_MULTIBINDER = Multibinders.ofBinaryOperator(RoutingServlet::merge);\n")),(0,l.kt)("p",null,"At last, we override ",(0,l.kt)("inlineCode",{parentName:"p"},"HttpServerLauncher#getBusinesLogicModule")," method to provide a combined DI ",(0,l.kt)("inlineCode",{parentName:"p"},"Module")," that contains\n",(0,l.kt)("inlineCode",{parentName:"p"},"ModuleA"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"ModuleB"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"ModuleC")," as well as an installed ",(0,l.kt)("inlineCode",{parentName:"p"},"Multibinder")," for DI Key ",(0,l.kt)("inlineCode",{parentName:"p"},"RoutingServlet.class"),"."),(0,l.kt)("p",null,"If we launch the example, we can see that there are no conflicts as conflicting servlets where successfully merged together.\nWe can open a web browser and visit any of the specified routes to make sure that routing is working properly:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"http://localhost:8080"},"/")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"http://localhost:8080/a"},"/a")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"http://localhost:8080/a/b"},"/a/b")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"http://localhost:8080/a/c"},"/a/c")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"http://localhost:8080/b"},"/b")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"http://localhost:8080/b/a"},"/b/a")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"http://localhost:8080/b/c"},"/b/c")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"http://localhost:8080/d"},"/d"))),(0,l.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"If you try to merge RoutingServlets that have identical routes mapped, an exception would be thrown"))),(0,l.kt)("h3",{id:"blocking-servlet-example"},"Blocking Servlet Example"),(0,l.kt)("p",null,"Shows how to create a new thread for processing some complex operations on a ",(0,l.kt)(i.Z,{text:"BlockingServlet",url:"/core-http/src/main/java/io/activej/http/BlockingServlet.java",mdxType:"Githublink"})),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java",metastring:"url=/examples/core/http/src/main/java/BlockingServletExample.java tag=EXAMPLE",url:"/examples/core/http/src/main/java/BlockingServletExample.java",tag:"EXAMPLE"},'@Provides\nAsyncServlet servlet(Reactor reactor, Executor executor) {\n  return RoutingServlet.builder(reactor)\n    .with("/", request -> HttpResponse.ok200()\n      .withHtml("<a href=\'hardWork\'>Do hard work</a>")\n      .toPromise())\n    .with("/hardWork", AsyncServlet.ofBlocking(executor, request -> {\n      Thread.sleep(2000); //Hard work\n      return HttpResponse.ok200()\n        .withHtml("Hard work is done")\n        .build();\n    }))\n    .build();\n}\n')),(0,l.kt)("p",null,"To check how the example works, open your favorite browser and go to ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:8080"},"localhost:8080")),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"#"},(0,l.kt)(i.Z,{isInline:!1,text:"See full example on GitHub",url:"/examples/core/http/src/main/java/BlockingServletExample.java",mdxType:"Githublink"}))),(0,l.kt)("h3",{id:"file-upload-example"},"File Upload Example"),(0,l.kt)("p",null,"In this example user uploads a file from local storage to the server:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java",metastring:"url=/examples/core/http/src/main/java/FileUploadExample.java tag=EXAMPLE",url:"/examples/core/http/src/main/java/FileUploadExample.java",tag:"EXAMPLE"},'@Provides\nIStaticLoader staticLoader(Reactor reactor, Executor executor) {\n  return IStaticLoader.ofClassPath(reactor, executor, "static/multipart/");\n}\n\n@Provides\nAsyncServlet servlet(Reactor reactor, IStaticLoader staticLoader, Executor executor) {\n  return RoutingServlet.builder(reactor)\n    .with(GET, "/*", StaticServlet.builder(reactor, staticLoader)\n      .withIndexHtml()\n      .build())\n    .with(POST, "/test", request ->\n      request.handleMultipart(AsyncMultipartDataHandler.file(fileName -> ChannelFileWriter.open(executor, path.resolve(fileName))))\n        .then($ -> HttpResponse.ok200()\n          .withPlainText("Upload successful")\n          .toPromise()))\n    .build();\n}\n')),(0,l.kt)("p",null,"To check how the example works, open your favorite browser and go to ",(0,l.kt)("a",{parentName:"p",href:"http://localhost:8080"},"localhost:8080")),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"#"},(0,l.kt)(i.Z,{isInline:!1,text:"See full example on GitHub",url:"/examples/core/http/src/main/java/FileUploadExample.java",mdxType:"Githublink"}))),(0,l.kt)("h3",{id:"client-example"},"Client Example"),(0,l.kt)("p",null,"This example shows how to create an HTTP client using ",(0,l.kt)("strong",{parentName:"p"},"Launcher"),", predefined ",(0,l.kt)(i.Z,{text:"HttpClient",url:"/core-http/src/main/java/io/activej/http/HttpClient.java",mdxType:"Githublink"}),",\nand ",(0,l.kt)(i.Z,{text:"DnsClient",url:"/core-http/src/main/java/io/activej/dns/DnsClient.java",mdxType:"Githublink"}),"\n(maps given domains to the corresponding IP addresses):"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java",metastring:"url=/examples/core/http/src/main/java/HttpClientExample.java tag=REGION_1",url:"/examples/core/http/src/main/java/HttpClientExample.java",tag:"REGION_1"},'@Provides\nIHttpClient client(NioReactor reactor, IDnsClient dnsClient) {\n  return HttpClient.builder(reactor)\n    .withDnsClient(dnsClient)\n    .build();\n}\n\n@Provides\nIDnsClient dnsClient(NioReactor reactor, Config config) {\n  return DnsClient.builder(reactor)\n    .withDnsServerAddress(config.get(ofInetAddress(), "dns.address"))\n    .withTimeout(config.get(ofDuration(), "dns.timeout"))\n    .build();\n}\n')),(0,l.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"To add support for HTTPS to ",(0,l.kt)("inlineCode",{parentName:"p"},"HttpClient")," you need to call ",(0,l.kt)("inlineCode",{parentName:"p"},"withSslEnabled")," builder method and pass ",(0,l.kt)("inlineCode",{parentName:"p"},"SSLContext")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"Executor")))),(0,l.kt)("p",null,"Override Launcher ",(0,l.kt)("inlineCode",{parentName:"p"},"getModule")," method to provide needed ",(0,l.kt)("a",{parentName:"p",href:"/boot/config"},"configs")," and ",(0,l.kt)("a",{parentName:"p",href:"/boot/servicegraph"},"ServiceGraph")," dependency graph:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java",metastring:"url=/examples/core/http/src/main/java/HttpClientExample.java tag=REGION_2",url:"/examples/core/http/src/main/java/HttpClientExample.java",tag:"REGION_2"},'@Override\nprotected Module getModule() {\n  return combine(\n    ServiceGraphModule.create(),\n    ConfigModule.builder()\n      .withEffectiveConfigLogger()\n      .build());\n}\n\n@Provides\nConfig config() {\n  return Config.create()\n    .with("dns.address", "8.8.8.8")\n    .with("dns.timeout", "5 seconds")\n    .overrideWith(Config.ofSystemProperties("config"));\n}\n')),(0,l.kt)("p",null,"Since our client extends ",(0,l.kt)("inlineCode",{parentName:"p"},"Launcher"),", it overrides method ",(0,l.kt)("inlineCode",{parentName:"p"},"run")," which defines the main functionality. In our case, it\nsends a request, waits for server response (either successful or failed) and then processes it:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java",metastring:"url=/examples/core/http/src/main/java/HttpClientExample.java tag=REGION_3",url:"/examples/core/http/src/main/java/HttpClientExample.java",tag:"REGION_3"},'@Override\nprotected void run() throws ExecutionException, InterruptedException {\n  String url = args.length != 0 ? args[0] : "http://127.0.0.1:8080/";\n  System.out.println("\\nHTTP request: " + url);\n  CompletableFuture<String> future = reactor.submit(() ->\n    httpClient.request(HttpRequest.get(url).build())\n      .then(response -> response.loadBody())\n      .map(body -> body.getString(UTF_8))\n  );\n  System.out.println("HTTP response: " + future.get());\n  System.out.println();\n}\n')),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"reactor.submit")," submits request sending and response receiving to the reactor. So, our main thread will wait until\n",(0,l.kt)("em",{parentName:"p"},"future")," in the reactor thread will return a result and only then the response will be printed out"),(0,l.kt)("p",null,"To check how the client works, launch ",(0,l.kt)("a",{parentName:"p",href:"#simple-hello-world-server"},'Simple "Hello World" Server')," or\n",(0,l.kt)("a",{parentName:"p",href:"#custom-server"},"Custom HTTP server")," and then run ",(0,l.kt)("strong",{parentName:"p"},"ClientExample")),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"#"},(0,l.kt)(i.Z,{isInline:!0,text:"See full example on GitHub",url:"/examples/core/http/src/main/java/HttpClientExample.java",mdxType:"Githublink"}))),(0,l.kt)("h3",{id:"multipart-data-handling-example"},"Multipart Data Handling Example"),(0,l.kt)("p",null,"POST requests can sometimes be encoded as ",(0,l.kt)("strong",{parentName:"p"},"Multipart/form-data"),". Such requests may contain multiple fields and files. The ",(0,l.kt)("inlineCode",{parentName:"p"},"HttpRequest#handleMultipart")," method can be used to handle a request containing multipart data. You need to pass an instance of ",(0,l.kt)("inlineCode",{parentName:"p"},"MultipartDataHandler")," to this method. There ",(0,l.kt)("inlineCode",{parentName:"p"},"MultipartDataHandler")," class contains several common handlers. You can use them to collect fields to a map, send a file to some ",(0,l.kt)("inlineCode",{parentName:"p"},"ChannelConsumer<ByteBuf>"),", etc. Or you can write your own ",(0,l.kt)("inlineCode",{parentName:"p"},"MultipartDataHandler")," if that is not enough."),(0,l.kt)("p",null,"In this example we will collect fields to a map end upload received files to some directory. After this we will log the collected fields and the number of uploaded files:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java",metastring:"url=/examples/core/http/src/main/java/MultipartDataHandlingExample.java tag=SERVLET",url:"/examples/core/http/src/main/java/MultipartDataHandlingExample.java",tag:"SERVLET"},'@Provides\nAsyncServlet servlet(Reactor reactor) {\n  return RoutingServlet.builder(reactor)\n    .with(POST, "/handleMultipart", request -> {\n      Map<String, String> fields = new HashMap<>();\n\n      return request.handleMultipart(AsyncMultipartDataHandler.fieldsToMap(fields, this::upload))\n        .then($ -> {\n          logger.info("Received fields: {}", fields);\n          logger.info("Uploaded {} files total", fileUploadsCount);\n          return HttpResponse.ok200().toPromise();\n        });\n    })\n    .build();\n}\n')),(0,l.kt)("p",null,"To upload the received file to a file system we will use a ",(0,l.kt)(i.Z,{text:"ChannelFileWritter",url:"/core-csp/src/main/java/io/activej/csp/file/ChannelFileWriter.java",mdxType:"Githublink"}),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java",metastring:"url=/examples/core/http/src/main/java/MultipartDataHandlingExample.java tag=UPLOAD",url:"/examples/core/http/src/main/java/MultipartDataHandlingExample.java",tag:"UPLOAD"},"private Promise<ChannelConsumer<ByteBuf>> upload(String filename) {\n  logger.info(\"Uploading file '{}' to {}\", filename, path);\n  return ChannelFileWriter.open(executor, path.resolve(filename))\n    .map(writer -> writer.withAcknowledgement(ack ->\n      ack.whenResult(() -> {\n        logger.info(\"Upload of file '{}' finished\", filename);\n        fileUploadsCount++;\n      })));\n}\n")),(0,l.kt)("p",null,"The ",(0,l.kt)("strong",{parentName:"p"},"Multipart/form-data")," request is manually forged and contains several fields and files. After running the example you\nshould see a similar logging output:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-text"},"Uploading file 'data.txt' to /tmp/multipart-data-files4909047508332989372\nUpload of file 'data.txt' finished\nUploading file 'key.txt' to /tmp/multipart-data-files4909047508332989372\nUpload of file 'key.txt' finished\nReceived fields: {last name=Johnson, first name=Alice, id=12345}\nUploaded 2 files total\n")),(0,l.kt)("p",null,"You may inspect the directory from logging output to ensure the files are uploaded."),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"#"},(0,l.kt)(i.Z,{text:"See full example on GitHub",url:"/examples/core/http/src/main/java/MultipartDataHandlingExample.java",mdxType:"Githublink"}))),(0,l.kt)("h3",{id:"websocket-pong-server"},"WebSocket Pong Server"),(0,l.kt)("p",null,'Let\'s create a "Pong" WebSocket server. To do this we need to\nprovide a ',(0,l.kt)("inlineCode",{parentName:"p"},"RoutingServlet")," and use ",(0,l.kt)("em",{parentName:"p"},"withWebSocket")," method to map a ",(0,l.kt)("strong",{parentName:"p"},"Consumer")," of ",(0,l.kt)("strong",{parentName:"p"},"WebSocket")," as a servlet on ",(0,l.kt)("inlineCode",{parentName:"p"},"/"),'path.\nOur server will simply receive the messages, print them out, and send back the "Pong" message.'),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java",metastring:"url=/examples/core/http/src/main/java/WebSocketPongServerExample.java tag=EXAMPLE",url:"/examples/core/http/src/main/java/WebSocketPongServerExample.java",tag:"EXAMPLE"},'@Provides\nAsyncServlet servlet(Reactor reactor) {\n  return RoutingServlet.builder(reactor)\n    .withWebSocket("/", webSocket -> webSocket.readMessage()\n      .whenResult(message -> System.out.println("Received:" + message.getText()))\n      .then(() -> webSocket.writeMessage(Message.text("Pong")))\n      .whenComplete(webSocket::close))\n    .build();\n}\n')),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"#"},(0,l.kt)(i.Z,{text:"See full example on GitHub",url:"/examples/core/http/src/main/java/WebSocketPongServerExample.java",mdxType:"Githublink"}))),(0,l.kt)("h3",{id:"websocket-ping-client"},"WebSocket Ping Client"),(0,l.kt)("p",null,'Now let\'s create a client that will send a "Ping" message to server via a WebSocket connection.'),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java",metastring:"url=/examples/core/http/src/main/java/WebSocketPingClientExample.java tag=EXAMPLE",url:"/examples/core/http/src/main/java/WebSocketPingClientExample.java",tag:"EXAMPLE"},'@Override\nprotected void run() throws ExecutionException, InterruptedException {\n  String url = args.length != 0 ? args[0] : "ws://127.0.0.1:8080/";\n  System.out.println("\\nWeb Socket request: " + url);\n  CompletableFuture<?> future = reactor.submit(() -> {\n    System.out.println("Sending: Ping");\n    return webSocketClient.webSocketRequest(HttpRequest.get(url).build())\n      .then(webSocket -> webSocket.writeMessage(Message.text("Ping"))\n        .then(webSocket::readMessage)\n        .whenResult(message -> System.out.println("Received: " + message.getText()))\n        .whenComplete(webSocket::close));\n  });\n  future.get();\n}\n')),(0,l.kt)("p",null,"First, we create a supplier and override its ",(0,l.kt)("inlineCode",{parentName:"p"},"get")," method using lambda. Here we call ",(0,l.kt)("inlineCode",{parentName:"p"},"IWebSocketClient.webSocketRequest")," that sends a request and returns a Promise of a ",(0,l.kt)(i.Z,{url:"/core-http/src/main/java/io/activej/http/IWebSocket.java",mdxType:"Githublink"},(0,l.kt)("inlineCode",{parentName:"p"},"IWebSocket")),". Then we create a ",(0,l.kt)("inlineCode",{parentName:"p"},"Function"),' that sends a "Ping" message and receives a response from server.'),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"#"},(0,l.kt)(i.Z,{text:"See full example on GitHub",url:"/examples/core/http/src/main/java/WebSocketPingClientExample.java",mdxType:"Githublink"}))))}h.isMDXComponent=!0}}]);